
> 何瑞杰
> 25110801
> 
>1. 完成老师课堂上布置的习题
>
> <font color="red">25/11/18 12:00截止</font>

---

> A spider and a fly move along a straight line. Each time period, the fly moves one unit left with prob. $p$, one right with prob. $p$, and stays still otherwise. The spider knows the position of the fly at the period beginning. The spider’s strategy
> * move one unit towards the fly if distance > 1
> * either move one unit or stay still if distance = 1
> * capture (terminate) if in the same position
> Problem: Capture the fly in minimum expected time


MDP Formulation: 
* State: $x_{k} \in \{ 0, \dots, n \}$
	* Initial state: $x_{0} = n$
	* Terminal state: $x_{k} = 0$
* Action: $u_{k} = 1$ If $x_{k} > 1$，$u_{k} = 0 \text{ or }1$ if $x_{k}$ = 1
* State Transition: $p_{i,j}(u)$ 
	* When $i \geqslant 2$. 
		* If the fly moves left or right, the spider moves towards it: $p_{i, i}(1) = p_{i,i-2}(1) = p$
		* If the fly stays at the same point: $p_{i,i-1}(1) = 1-2p$
	* When $i=1$ 
		* If the fly and the spider both moves one step towards the other $p_{1,1}(1) = p + p = 2p$
		* If the fly stays, spider may or maynot move towards it: $p_{1,0}(1) = p_{1,1}(0) = 1-2p$
		* If the spider stays $p_{1,2}(0) = p_{1,0}(0) = p$
* Cost: When $i \neq 0$, each move costs $g(i,u) = 1$.

Bellman's Equation
$$
J^{*}(i) = \min\limits_{u \in U(i)}~\left[ g(i,u) + \sum\limits_{j=1}^{n} p_{i,j}(u)J^{*}(j) \right] 
$$

Solving the Bellman's Equation
When $i > 2$，we have
$$
\begin{align}
J^{*}(i) &= \min\limits_{u \in U(i)}~\left[ g(i,u) + \sum\limits_{j=1}^{n} p_{i,j}(u)J^{*}(j) \right] \\
&= \min\limits_{u \in \{ 1 \}}~\left[ 1 + \sum\limits_{j=i-2}^{i} p_{i,j}(1)J^{*}(j) \right]\\
&=  1 + p_{i,i-2}(1)J^{*}(i-2) + p_{i, i-1}(1)J^{*}(i-1) + p_{i,i}(1)J^{*}(i) \\
&=  1 + pJ^{*}(i-2) + (1-2p)J^{*}(i-1) + pJ^{*}(i) \\
\end{align}
$$
When $i = 0$, we have $J^{*}{0} = 0$
When $i = 1$, 
$$
\begin{align}
J^{*}(1) &= \min\limits_{u \in \{ 0, 1 \}}~\left[ g(1,u) + \sum\limits_{j=0}^{2} p_{1,j}(u)J^{*}(j) \right] \\
&= \min \begin{cases}
g(1, 1)  + \sum\limits_{j=0}^{1} p_{1,j}(1)J^{*}(j) \\
g(1, 0) + \sum\limits_{j=0}^{2} p_{1,j}(0)J^{*}(j) 
\end{cases}\\
&= \min \begin{cases}
1 + 2p J^{*}(1) \\
1 + (1-2p)J^{*}(1) + pJ^{*}(2) 
\end{cases}
\end{align}
$$
While when $i=2$, we have
$$
\begin{align}
J^{*}(2) &= \min\limits_{u \in \{ 0, 1 \}}~\left[ g(2,u) + \sum\limits_{j=0}^{2} p_{1,j}(u)J^{*}(j) \right] \\
&= 1 + pJ^{*}(0) + (1-2p)J^{*}(1) + pJ^{*}(2)
\end{align}
$$
thus $\displaystyle J^{*}(2) = \frac{1}{1-p}[1 + (1-2p)J^{*}(1)] = \frac{1}{1-p} + \frac{1-2p}{1-p}J^{*}(1)$. Therefore 
$$
\begin{align}
J^{*}(1) = 1 + \min \left\{  \underbrace{ 2pJ^{*}(1) }_{ a }, \underbrace{ \frac{1}{1-p} + \frac{1-2p}{1-p}J^{*}(1)  }_{ b } \right\}
\end{align}
$$
If $J^{*}(1) = 1 + 2p J^{*}(1)$ ($a \leqslant b$), we have $J^{*}(1) = \displaystyle \frac{1}{1-2p}$
else ($a > b$), we have $J^{*}(1) = \displaystyle \frac{2-p}{1-p} + \frac{1-2p}{1-p}J^{*}(1) \implies J^{*}(1)=\frac{2-p}{p} = \frac{2}{p} - 1$

We can calculate $J^{*}(n)$ as the minimuim expected time for the spider capturing the fly.

