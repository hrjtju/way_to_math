
可以从动力学角度看复杂性阶梯：每一级别对应不同级别的非线性动力系统。动力系统也和大模型的进化有密切联系。

# 0 何谓非线性动力学

所谓动力学（动力系统）指的是下面的迭代方程，其中 $X_{t}$ 、$X_{t+1}$ 是系统的状态，它可以使标量、向量、矩阵、甚至更复杂的对象，例如分布函数。$f$ 是一个映射，它将系统在 $t$ 时刻的状态
$$
X_{t+1} = f(X_{t})
$$
可以看到这个系统的演化是 Markov 的，即下一状态只取决于当前状态。所谓 **非线性**，是指迭代映射 $f$ 是非线性的。这个迭代方程包罗万象，宇宙是一个动态系统——$X$ 是宇宙的状态，$f$ 是所有已知或未知的物理法则。

所谓线性是指一个函数 $f$，它在输入线性组合处的取值相当于对输入分别取值后的线性组合，即 $f(ax + by) = af(x) + bf(y)$。直观来看，简单的线性函数的图像是一条直线或一个平面。而非线性函数不满足上面的性质，它的图像可以是一条曲线。下一节将会给出丰富的例子。

<图 1：线性和非线性函数>

## 0.1 非线性动力学的例子
### 0.1.1 三体运动

三体运动是著名科幻小说《三体》的主要背景，它由 Henri Poincare（庞加莱）提出。最早的时候人们研究人类所居住的太阳系（九大行星和太阳，当然现在是八大）是否稳定，结果发现这个问题太过复杂。将问题逐渐简化后变成的三体问题，却成为了一个很大的障碍：三体系统的轨迹异常混乱。

三体问题说的是宇宙空间中的三个天体，受到相互之间引力而各自运动。如果用 $x_{i}$ 表示第 $i$ 个天体的位置，$f_{j,i}$ 表示天体 $j$ 对天体 $i$ 的引力，并假设三个天体质量相同，我们由牛顿第三定律和万有引力定律得到下面的方程：
$$
m \displaystyle \underbrace{ \frac{ \mathrm{d}^{2}x_{i} }{ \mathrm{d}t^{2} } }_{ 加速度 } = \sum\limits_{j=1}^{3} f_{j,i} = \sum\limits_{j=1}^{3} \frac{Gm^{2}(x_{j} - x_{i})}{|x_{j} - x_{i}|^{3}}
$$
![[Pasted image 20251021101041.png|500]]

### 0.1.2 Boids 模型

现在简单的非线性系统可在计算机中得到较好的模拟，且与日常生活关系紧密。Boids 模型最初由计算机图形学家 Boids 提出，多体系统如果遵循三条简单的规则：分离、对齐、聚集，就可以逼真地模拟动物群体的行为。后续提出的简化版本 Vicsek 模型将其写成了微分方程的形式。

![[Pasted image 20251021101335.png|400]]


### 0.1.3 生命游戏

一个不是以微分方程形式出现的系统是在上世纪的美国风靡一时的生命游戏，它的提出者是 Conway（康威）。它描绘了一个网格世界，每个网格代表一个细胞，后者有存活和死亡两种状态。该细胞在下一时刻的状态取决于它周围八个邻居的状态。具体而言，演化的规则如下：

1. [孤独] 若存活细胞旁边的存活细胞少于两个，则死亡
2. [稳定] 若存活细胞旁边的存活细胞数量为 2 或 3，则继续存活
3. [拥挤] 若存活细胞旁边的存活细胞多于三个，则死亡
4. [繁殖] 若已死亡细胞旁边恰有三个活细胞，则复活

![[Pasted image 20251021101445.png|400]]

如果假设某个细胞的状态为 $c$，它的八个邻居的存活数为 $n_{c}$，那么它的下一个状态 $f(c)$ 可以写为
$$
f(c, n) = \begin{cases}
1, & c = 0, n_{c} = 3\\
1, & c = 1, n_{c} \in \{ 2, 3 \}\\
0, & \text{otherwise}
\end{cases}
$$
![[Pasted image 20251021101607.png|400]]
现在考虑整个网格世界，所有细胞的状态可以堆叠成一个向量 $\boldsymbol{c}$，对应于每个分量（细胞）的当前状态存活邻居个数是 $\boldsymbol{c}$ 的函数 $\boldsymbol{n}_{\boldsymbol{c}}$。所以生命游戏的演化规律也可以写成
$$
\boldsymbol{c}_{t+1} = f(\boldsymbol{c}_{t})
$$

### 0.1.4 Navier-Stokes 方程

物理学中也有许多非线性动力系统。流体力学中的经典模型 Navier-Stokes 方程是一个偏微分方程，它描述了流体的行为。
$$
\begin{align}
\nabla \cdot \boldsymbol{V} &= 0\\
 \underbrace{\rho  \frac{D \boldsymbol{V}}{D t} }_{ 全微分 } &{\color{gray} \;= \rho\left[ \displaystyle \frac{ \partial \boldsymbol{V} }{ \partial t } + (\boldsymbol{V} \cdot \nabla)\boldsymbol{V} \right]  } = \underbrace{ -\nabla p }_{ 压强梯度 } + \rho \boldsymbol{g} + \underbrace{ \mu \nabla^{2} \boldsymbol{V} }_{ 扩散 }
\end{align}
$$
我们依然可以将它与最初的模型 $X_{t+1} = f(X_{t})$ 建立联系：将流体存在的空间切成网格，将每个网格视为最小单元，做受力分析能得到它下一个时刻的状态仅和自身以及邻居单元有关。我们将所有网格的状态集合成一个总状态 $X$，就能得到类似 $X_{t+1} = f(X_{t})$ 的方程了。此时我们将网格加细，整个系统就会趋于一个无穷维的非线性动力系统。

### 0.1.5 Brown 运动

Brown 运动最初被植物学家 Brown（布朗）提出，用于描述花粉在水面的独立不规则运动，后被 Einstein（爱因斯坦）、Wiener（维纳）等人进一步研究并严格化。它是一个随机过程，一般用 $W(\cdot)$ 或 $B(\cdot)$ 表示。它满足下面四条性质：

1. $W(0) = 0 \quad \text{a.s.}$
2. （增量独立性）对任意 $t_{1} \leqslant t_{2} \leqslant t_{3} \leqslant t_{4}$，有 $W(t_{4}) - W(t_{3}) \perp W(t_{2}) - W(t_{1})$
3. （Gauss 分布）对任意 $s \leqslant t$，有 $W(t) - W(s) \sim \mathcal{N}(0, \sigma^{2}(t - s))$

Brown 运动作为一个基本组件广泛出现在随机微分方程（stochastic differential equations, SDE）中，后者的一个典型的形式是
$$
\frac{\mathrm{d}X}{\mathrm{d}t} = f(X, t) + \mathrm{d}W
$$
其中 $f(X, t)$ 称为漂移 (drift) 项，后者称为扩散 (diffusion) 项。对于从原点开始随机运动的一群粒子，若不考虑单个“粒子”，而是考虑无穷多的集中在原点处的粒子，它们的分布随时间的变化可以由下面的**扩散方程**刻画：
$$
\displaystyle \frac{ \partial ^{2}p(\boldsymbol{x}, t) }{ \partial t^{2} } = -\nabla \cdot [p(x, t) \cdot v] + \nabla^{2}[p(x, t) \cdot D]
$$
上式是一个确定的微分方程，其中的二阶偏导可以以一些方法转换成一阶，再将其离散化后也变成 $X_{t+1} = f(X_{t})$ 的经典模式。一般地，对于 $\displaystyle \frac{\mathrm{d}X}{\mathrm{d}t} = f(X, t) + \mathrm{d}W$ 这样的方程，也有一个确定版本的偏微分方程对应，这被称为 Fokker-Plank 方程，这也是统计力学中的一个重要对象。

<图片>

### 0.1.6 Schrödinger  方程

Schrödinger  方程描述一个粒子在一维势阱中波函数的演化：
$$
\begin{align}
i \hbar \displaystyle \frac{ \partial   }{ \partial t }  \psi(x, t) &= - \frac{\hbar^{2}}{2m} \displaystyle \frac{ \partial   }{ \partial x^{2} } \psi(x, t) + V(x) \psi(x, t)\\
\psi(x, t) &= [A\sin(kx) + B\cos(kx)]e^{-\mathrm{i}wt}
\end{align}
$$
它也可以转化为一阶，也是一个动力系统。在无观察者的情况下，系统以原版 Schrödinger  方程模式演化。测量时，需要进行“投影”：
$$
\begin{align}
P(x_{i}) &= \text{tr}(\Pi_{i} \rho)
\end{align}
$$
此时的系统更像是一个包含玩家的游戏：一个非自主（non-autonomous）的动力系统，观察者之于系统相当于系统相当于玩家之于游戏。


## 0.2 不为非线性动力学的例子
### 0.2.1 Ising 模型

Ising 模型描述的是一个二维网格世界中的若干“磁针”。每个“磁针”有朝上或朝下两个状态，系统的势函数由 $E_{\{ s_{i} \}}$ 给出，且系统处于状态 $\{ s_{i} \}$ 的概率是 $p(\{ s_{i} \})$，这是一个能量模型。
$$
\begin{align}
E_{\{ s_{i} \}} &= -J \sum\limits_{\left\langle i, j \right\rangle } s_{i} s_{j} - H \sum\limits_{i}^{N} s_{i}\\
p(\{ s_{i} \}) &= \frac{1}{Z} \exp \left\{ - \frac{E_{\{ s_{i} \}}}{kT} \right\} \\
Z &= \sum\limits_{\{ s_{i} \}} \exp \left\{ -\frac{E_{\{ s_{i} \}}}{kT} \right\} 
\end{align} 
$$
显然，这样描述下的 Ising 模型并没有演化的成分，因此不是一个动力系统。然而，Glauber 动力学可以将其转换成一个动力系统，这使得我们可以在计算机中模拟 Ising 模型。

![[Pasted image 20251025205021.png|600]]


### 0.2.2 量子场论

量子场论描述的不是动力系统。对系统定义 Lagrange 量 $L$ 后，可以定义系统演化所有轨迹的分布 $\phi(\boldsymbol{x}, t)$。

![[Pasted image 20251025205810.png|600]]


---

在前不久揭晓的2025年物理诺奖中，也有动力系统的影子。三维获奖者研究中的一个基础对象 Josephson 结在本书中有着重讨论，它的状态构成下面的方程
$$
\frac{\hbar C}{2e} \ddot{\phi} + \frac{\hbar}{2eR} \dot{\phi} + I_{c} \sin \phi = I
$$
并且会产生如下图所示的迟滞效应。
![[Pasted image 20251026111359.png|400]]

**非线性动力系统小史**
![[Pasted image 20251026111536.png|400]]

**非线性动力系统再各领域的发展**
![[Pasted image 20251020220634.png|600]]


# 1 有序和无序

## 1.1 Logistic 映射

Logistic 映射最初由 May 提出，用于描述种群受环境限制的增长。其中 $X_{t}$ 是一个归一化种群数量，即当前种群数量与最大允许的种群数量之比，$r$ 表示增长率。如果没有后面一项，种群数量就会指数增长，这不符合直觉——因此第二项 $1-X_{t}$ 描述的是种群数量较大时收到环境的限制。显然这个迭代方程是二次函数，形式非常简单。
$$
X_{t+1} = rX_{t}(1-X_{t})
$$
Logistic 映射脱胎于微分方程的版本：
$$
\displaystyle \frac{ \mathrm{d}x }{ \mathrm{d}t } = rx(1-x)
$$
但该微分方程的解都是随时间演化最终会收敛的 Logistic 函数，远远没有离散的版本演化轨迹复杂、有趣。

### 1.1.1 Logistic 映射的简单数值实验

当 $r$ 比较小 ($0 \leqslant r < 1$) 时，系统总是收敛到零.

当 $1 < r < 3$ 时，系统会收敛到不动点 (fixed point). $r$ 接近 $3$ 时，系统先震荡后收敛。

当 $r = 3$ 时，系统会在一定时间后再两个状态之间震荡，$r = 3.5$ 时，系统会在四个状态之间震荡。继续增加 $r$ 到合适的值，系统会在 $2^{n}$ 个点之间震荡循环。

当 $r > 3$ ，且不是上述周期的情况时，会出现混沌：经过的每个状态都和之前的不一样，轨道看起来杂乱无章，无法预测，且系统的演化对初始值敏感异常。——相比之下，上面几种情况下稍稍改变初值，并不会使系统的演化产生很大的改变。

### 1.1.2 极限演化行为

若统计不同增长率下系统从若干个初值开始演化一百步的取值集合，可以得到如下的分岔图。

![[Pasted image 20251026113348.png|600]]

可以看到，第一个分岔点就对应着 $r = 3$，图中的阴影区域就是混沌状态对应的 $r$ 的区域，它们夹在周期状态的取值之间。

### 1.1.3 不动点

**一阶不动点**

所谓（一阶）不动点就是系统演化到一定程度后就待在该点“不动”，也即当 $n$ 充分大时，有 $X_{n+1} = X_{n} = f(X_{n})$。在 Logistic 映射的例子中，可以简单得令 $X = rX(1-X)$ 得到，即 $f(X) = X$ 与 $g(X) = rX(1-X)$ 的交点，计算得到 $\displaystyle X = 1-\frac{1}{r}$ 或 $X = 0$，由于 $X = 0$ 是一个平凡的不稳定不动点，因此零点并未画在上面的分岔图上。

**二阶不动点**

类似地，二阶不动点事系统演化到一定程度上在两个状态中循环跳跃的点，其求法和一阶不动点类似，即令 $X = f(f(X))$。它对应的就是分岔图中第一个分岔后的 $r$ 的取值。二阶不动点中一定包含一阶不动点，但在 Logistic 映射中二阶不动点中包含的那个一阶不动点事不稳定的，因此在分岔图中只有两条线，而不是三条。

更高阶不动点也可以类似地计算求解。

### 1.1.4 分岔

注意分岔图中的分岔点。系统的稳态性质在这个点处发生突变（例如从一个不动点变成两个周期点）。可以以直观的方式看到第一个分岔点：考虑 $f(X) = X$ 和 $g(X) = rX(1-X)[1-rX(1-X)]$ 的图像，当二者从一个相交点变成相切，此时对应的 $r$ 就是系统的第一个分岔点。

另外注意到，分岔图中的每个分岔点的长相都相似，这也体现在若干步迭代的不动点图中交点左侧和右侧两块区域和一阶不动点图的相似性。

![[Pasted image 20251026120026.png|600]]

### 1.1.5 重整化

如果我们将视角转化为函数的迭代（$f, f \circ f, f \circ f \circ f, \dots$）而不是状态的迭代，并做一些关于相似性的假设（重整化方程），就得到了函数空间中的动力系统。该动力系统可能存在一个不动点，求解该不动点得到的结果和关于分岔的费根鲍姆常数有联系。

---

上面的例子可以看到，动力系统的演化有不动点、周期、混沌三种状态，我们想知道是不是只有这三种？有的话它是什么？

很遗憾地，连续的动力系统中只能出现前三种，而离散动力系统重会出现第四种：复杂。

## 1.2 元胞自动机

一维元胞自动机是一维网格，最简单地形式中每个格子只有 $0$ 和 $1$ 两种状态，当前格子的下一个状态仅取决于自己和相邻两个邻居格点的状态——这一共有八种可能性。我们只需为每种组合指定一个中间格子下一状态，就得到了一个系统的演化规则（一共有 $256$ 种）。

![[Pasted image 20251026121152.png|500]]

我们可以将元胞自动机演化的每一步按照时间顺序纵向堆叠，得到一个方便阅读的二维图像，以表示其演化规律。
![[Pasted image 20251026121415.png|500]]

我们可以用这个工具依据系统的演化行为对不同规则进行分类。可以看到 $224$ 号、$132$ 号、$203$ 号规则演化一段时间后会达到稳定，这对应着不动点。$208$ 号 对应着周期，而 $150$ 号、$151$ 号是混沌。

![[Pasted image 20251026121729.png|500]]

## 1.3 混沌边缘

然而存在其他状态，并不能归类于以上三种。下图所示为第 $110$ 号规则在不同初始状态的演化规则。可以观察到系统的演化中出现了一些特殊的结构：“粒子”。这些粒子在世界中移动，传递信息。这种状态并不会在前三种类型中出现， Wolfram 称其为复杂。

![[Pasted image 20251026121941.png|500]]

Langton 提出了表征混乱程度的常数 $\lambda$，当它从 $0$ 逐渐增大到 $1$ 时，系统的演化会依次出现不动点、周期、复杂、混沌四种状态。不动点和周期点称为有序相，混沌称为无序相，而复杂处于有序相和无序相之间，Langton 也称其为 “混沌边缘”。下图中的纵坐标是描述复杂性的指标，可以是互信息。它在复杂状态中达到最大值。

![[Pasted image 20251026122321.png]]


# 2 多重尺度

**斑图**：系统涌现出的特殊群体运动模式

* 台风是相比于地球而言介观的现象，是由水蒸气、空气分子构成的
* 复杂状态的一维元胞自动机中出现的由元胞构成的“粒子”
* 二维元胞自动机中的“滑翔机”、“飞船”等看起来在移动的对象

**“新物理规律”**
James Crutchfield 利用一维元胞自动机执行涌现计算，例如比较输入方格中黑色和白色数量大小关系。这个任务困难在于元胞自动机演化是局部的，而任务描述的是输入数据的全局性质。

![[Pasted image 20251026151524.png|500]]
![[Pasted image 20251026151814.png|500]]

将上图中的边界提取，可以看出有许多不同种类的 “粒子”：
![[Pasted image 20251026152100.png|500]]
可以看到，问题的解答涌现出一个物理规律或是因果规律。

## 2.1 因果涌现

Erik Hoel 和 Giulio Tononi 提出了因果涌现的框架，通过在微观和介观尺度描述系统的演化。在上面的例子中，介观视角下看到的就是各种例子，微观视角下看到的就是一个个小元胞。在 Boid 模型中，介观就是鸟群的重心、平均朝向；微观就是每只鸟的运动状态。宏观状态可以通过粗粒化（coarse-graining）得到系统的介观状态，但得到这样的粗粒化映射 $\phi$ 存在一定困难。

如果介观运动规律的因果效应大于微观的因果效应时，我们认为该系统中存在因果涌现。

![[Pasted image 20251026152504.png|500]]
自然界中不同尺度下有不同的规律，如生态系统、生物群落、生物个体、器官、组织、细胞和基本物理规律。

## 2.2 因果等价原理

我们希望宏观和微观可以并行存在，并充分享受不同尺度给我们带来的便利。学者 Sergey B. Yurchenko 提出了因果等价原理

1. 不同尺度有不同规律
2. 不同尺度的演化之间互不冲突

![[Pasted image 20251026154558.png]]

## 2.3 向下因果

另一个具有正义的理论是向下因果，它指出存在宏观指向微观的因果箭头。例如人类的意识可以控制手以改变身体其他部分的细胞状态。图中右侧的论文定量描述了这个因果效应。

![[Pasted image 20251026154759.png|500]]

我们研究带参数的动力系统时，我们往往会将参数视为常数。如果将参数变化，我们可以看到一系列不同的动力学。当改变宏观的参数 $W$ 时，微观的动力系统会因此改变。每提升一个尺度，下层尺度中动力学的参数在上层的尺度中可以发现正在根据这一尺度的动力学发生着变化，从而形成向下的因果箭头。学习同时也在多尺度出现，当我们的视角受限于某一尺度时，就难以看到尺度的层级，因此需要对多尺度进行建模。

![[Pasted image 20251026154955.png|500]]

如果将尺度放大，在建模中如何分辨处于不同尺度的变量？这就和快慢变量分离有关。例如在下面的系统中，$q_{2}$ 的下降速度远大于 $q_{1}$：
$$
\begin{align}
\displaystyle \frac{ \mathrm{d}q_{1} }{ \mathrm{d}t } &= -\gamma_{1}q_{1} - aq_{1}q_{2}\\
\displaystyle \frac{ \mathrm{d}q_{2} }{ \mathrm{d}t } &= -\gamma_{2}q_{2} - bq_{2}^{2}
\end{align}
$$
其中 $\gamma_{2} \gg \gamma_{1}$。此时会出现役使原理（slave principle），即慢变量会驱动快变量；此时可以不考虑快变量，以对原始系统降维。如果将慢变量看做快变量演化的参数，向下因果就出现了。

# 3 自指

如果出现了快慢变量的分离，就可能进一步演化出自指效应。

**通用图灵机**
一个通用图灵机 $U$ 可以通过调节参数 $P$ 以模拟任何一台其他的图灵机 $X$。实际上，我们常用的计算机就是一个通用的图灵机，计算机中不同的程序所实现的功能就是这台通用图灵机在模拟其他图灵机。当然这个通用图灵机可以模拟它自己，例如我们可以在计算机中运行虚拟机。然而，通用图灵机依然是一个离散动力系统，它的状态是纸带和读写头的状态，动力学是其中加载的程序。

![[Pasted image 20251026160530.png|500]]

**S-m-n 定理**
对任意 $f(x, y)$ 存在一个机器 $k(x)$，使得 $f(x, y) \simeq \phi_{k(x)}(y)$。此时 $x$ 是一个参数，可以将其理解为更高尺度的慢变量。对于通用图灵机，和一个可计算的 $n$ 元函数，适配所有这样 $n$ 元函数的通用函数是 $n+1$ 元函数：
$$
\psi_{U}(e, x_{1}, \dots, x_{n}) \simeq \psi_{e}(x_{1}, \dots, x_{n}).
$$
## 3.1 泛函动力学

泛函动力学在自然中广泛存在。例如蛋白质相互作用：酶可以参与操控其他蛋白质，从而改变其他蛋白质生成或消耗的动力学，会形成类似化学反应链的多样性。大语言模型中的上下文学习 (in-context learning) 实现给定少量上下文或零上下文让模型“学习”到新的知识。注意力中的权重是慢变量，它可以对快变量，输入数据特征的演化产生调节，从而出现向下因果的现象。

![[Pasted image 20251026161723.png|400]]

另一个有趣的现象是自指，例如通用图灵机可以修改自己的代码。在计算理论中属于**第二递归定理**。再如人类通过反思可以改变自身的行为。但我们目前并不知道具有第二递归定理这样功能的实体（如人类）是如何演化得到的。

## 3.2 复杂性阶梯

由此观之，从原子分子，直到细胞、个体、社会；从非线性动力学，到涌现、通用图灵机和第二递归定理，存在这样一个复杂性阶梯。

![[Pasted image 20251026162150.png|600]]

# 4 关于非线性动力学的讨论



ps. 张江老师关于复杂系统的新书预计将在明年面世

![[Pasted image 20251026124459.png|300]]