> 何瑞杰
> 25110801
> 
>1. 完成老师课堂上布置的习题
>
> <font color="red">25/11/11 12:00截止</font>

---

> Consider the system $$x_{k+1} = x_{k} + u_{k} + w_{k}, \quad k=1, 2, 3$$with initial state $x_{0}=5$, and the cost function $$\sum\limits_{k=0}^{3} (x_{k}^{2} + u_{k}^{2}).$$
> Apply the DP algorithm for the following cases
> (a) The contrrol constraint set $U_{k}(x_{k})$ is $\{ u | 0 \leqslant x_{k} + u \leqslant 5, u \in \mathbb{Z} \}$ for all $x_{k}$ and $k$, and the disturbance $w_{k}$ is equal to $0$ for all $k$.
> (b) Ihe control constraint is as in part(a)and the disturbance wk takes thevalues $-1$ and $1$ with equal probability $1/2$ for all $x_k$ and $u_k$,except if $x_k+u_k$ is equal to $0$ or $5$,in which case $w_k=0$ with probability $1$.

**(a)**
$J_{4}(x) = 0$
$J_{3}(x) = \min\limits_{u}~\{ x^{2} + u^{2} + J_{4} \} = x^{2}$
$\displaystyle J_{2}(x) = \min\limits_{u}~\{ x^{2} + u^{2} + J_{3}(x + u)\} = 2\min\limits_{u}~\{ x^{2} + u^{2} + xu \} = \frac{3}{2} x^{2}$
$\displaystyle J_{1}(x) = \min\limits_{u}~\{ x^{2} + u^{2} + J_{2}(x + u) \} = \min\limits_{u}~\left\{ x^{2} + u^{2} + \frac{3}{2} (x+u)^{2} \right\}=\frac{8}{5}x^{2}=40$

**(b)**
$J_{4}(x) = 0$
$J_{3}(x) = \min\limits_{u}~\{ x^{2} + u^{2} + \mathbb{E}[J_{4}(x + u + w)] \} = x^{2}$
$\displaystyle J_{2} = \min\limits_{u}~\{ x^{2} + u^{2} + \mathbb{E}[J_{3}(x + u + w)]\} = \min\limits_{u}~\left\{  x^{2} + u^{2} + \frac{1}{2} J_{3}(x + u + 1) + \frac{1}{2} J_{3}(x + u - 1) \right\}$
$\displaystyle \quad = \min\limits_{u}~ \begin{cases} \displaystyle  x^{2} + u^{2} + (x + u)^{2} + 1  & 0 < x + u < 5\\[0.5em] \displaystyle  2x^{2}  & x+u = 0\\[0.5em] \displaystyle  x^{2} + u^{2} + 25  & x + u = 5\end{cases}$
we can explicitly compute $J_{2}(0), \dots, J_{2}(5)$.
$J_{2}(0) = 0$，$J_{2}(5) = \displaystyle 39$
$J_{2}(1) = 2$，$J_{2}(2)=7$，$J_{2}(3)=15$，$J_{3}(4) = 25$

$\displaystyle J_{1} = \min\limits_{u}~\{ x^{2} + u^{2} + \mathbb{E}[J_{2}(x + u + w)] \} = \min\limits_{u}~\left\{  25 + u^{2} + \frac{1}{2}J_{2}(5+u+1) + \frac{1}{2}J_{2}(5+u-1) \right\}$
if $u = -5, x+u=0$，$J_{1} = \min\limits_{u}~\{ 50 + J_{2}(0) \} = 50$
if $u = 0, x + u = 5$，$\displaystyle J_{1} = \min\limits_{u}~\{ 25 + J_{2}(5)\} = 64$
if $x + u \in (0, 5)$ i.e. $u \in (-5, -1)$
$\displaystyle J_{1} = \min\limits_{u}~\left\{  25 + u^{2} + \frac{1}{2}J_{2}(u+6) + \frac{1}{2} J_{2}(u+4)  \right\}$.
1. $u=-1$，we have $\displaystyle J_{1} = 26 + \frac{1}{2}J_{2}(5) + \frac{1}{2}J_{2}(3) = 53$
2. $u = -2$，$J_{1} = 29 + \displaystyle \frac{1}{2}J_{2}(4) + \frac{1}{2}J_{2}(2) =45$
3. $u = -3$，$J_{1} = 34 + \displaystyle \frac{1}{2}J_{2}(3) + \frac{1}{2}J_{2}(1) =42.5$
4. $u=-4$，$J_{1} = 41 + \displaystyle \frac{1}{2}J_{2}(2) + \frac{1}{2}J_{2}(0)=44.5$
Thus $J_{1} = \text{mincost} = 42.5$
