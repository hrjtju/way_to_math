> 何瑞杰
> 25110801
> 1. 整理老师课堂上讲解的例题
> 2. 完成讲义第3章 3.6节中关于3.1-3.3节知识点的课后习题
> <font color="red">25/10/28 12:00截止</font>

## 3.2 状态分类

> **例题**
> 
> 给定概率转移矩阵，$P^{n}$ 表示的意义是什么？如何计算 $P^{n}$?

$(P^{n})_{i,j}$ 表示的是 $i$ 状态通过 $n$ 步转移到 $j$ 状态的概率。
对 $P$ 做对角化 $P = U\Lambda U^{-1}$，因此 $P^{n} = U\Lambda^{n}P^{-1}$

> **例题**
> 
> 假设 $[P ]$ 是一个有限状态马尔可夫链的转移矩阵，状态 $i$ 是一个常返态。证明如果 $P_{ii} > 0$，则 状态 $i$ 是非周期的。

若 $P_{i,i} = P^{(1)}_{i,i} > 0$，这说明其有一个周期为 $1$。记状态 $i$ 的所有周期构成的集合为 $A=\{ n: P^{(n)}_{i,i} > 0 \}$，有 $\text{gcd}\{ A \} = \text{gcd}\{ 1, \dots \} \equiv 1$，即 $i$ 是非周期的。

> **例题**
> 
> 证明每个 $M < ∞$ 状态马尔科夫链包含至少一个常返态集合。

假如对所有 $i < M$ 的状态，都是非常返的，则有对任意 $i$，存在 $j$，有 $i \rightarrow j_{i}$，但 $j_{i} \nrightarrow i$。考虑下面的两个链：
$$
\begin{align}
i_{1} \rightarrow i_{2} \rightarrow  i_{3} \rightarrow \cdots \rightarrow  i_{M}\\
i_{1} \nleftarrow i_{2} \nleftarrow  i_{3} \nleftarrow \cdots \nleftarrow i_{M} 
\end{align}
$$
其中 $i_{k} \rightarrow i_{k+1}$ 可达，而 $i_{k+1} \nrightarrow i_{k}$。由抽屉原理，$i_{1}, \dots, i_{M}$ 这些状态中，要么遍历 Markov 链的全部状态，要么至少存在某个状态 $j$ 在上面的序列中重复出现。如果存在这样的 $j$，那么该状态是常返的，矛盾。

因此上述的链一定不重复，即遍历整个集合。此时考虑状态 $i_{M}$。由于假设中 Markov 链的每个状态都不常返，则也存在 $i_{M+1}$，使得 $i_{M} \rightarrow i_{M+1}$ 但 $i_{M} \nrightarrow i_{M+1}$。然而 $i_{M+1}$ 是 Markov 链中的某个状态，因此一定存在于 $i_{1}, \dots, i_{M}$ 中。这样就有 $i_{M} \leftrightarrow i_{M+1}$，矛盾。

综上所述，有限状态的（时齐） Markov 链一定存在至少一个常返态。

> **例题**
> 
> 考虑一个有限状态的马尔可夫链，其中某个给定的状态，比如状态 $1$，可以从任何其他状态到达。证明该链恰好有一个常返类 $R$，且状态 $1 \in R$。（注意，此时该链是单链。）

对 Markov 链中的任意状态 $i$，都有 $i \rightarrow 1$。特殊地，当 $i=1$ 时，有 $1 \rightarrow 1$。若存在 $j$ 使得 $1 \rightarrow j$，则根据前面的假定，一定有 $1 \rightarrow j \rightarrow 1$。由于 $j$ 可以是所有的 $1$ 可达的状态，因此有 $1$ 是常返态，且该链至少有一个常返类 $R$，其中 $1 \in R$。

> **例题**
> 
> 如何将下图推广到任意数量（$M ≥ 3$）的状态，其中包含一个 $M$ 个节点的环和一个 $M − 1$ 个节点的环。对于 $M = 4$，假设节点 1 是不在 $M − 1$个节点的环中的节点。列出从节点 $1$ 在 $n$ 步内可以到达的 状态集合，其中 $n ≤ 12$，并证明定理 3.15中的界限等式满足。解释为什么该结果对于所有更大的 $M$ 也成立。
> ![](Pasted%20image%2020251022145354.png)

> 考虑一个具有一个常返类的马尔可夫链，该常返类包含 $r$ 个状态，记为 ${1，2， . . . ，r}$，并 且还有 $M − r$ 个其他瞬态状态。证明对于所有 $j ≤ r$ 和 $n ≥ (r − 1)2 + 1 + M − r$，有 $P^{(n)}_{ij} > 0$。


> (a) 假设有一个具有 $M ≥ 3$ 个状态的任意遍历马尔可夫链中最小循环的状态数为 $τ$ 。证明对于所有 $n ≥ (M − 2)τ + M$ ，有 $P^{n}_{ij} > 0$。
>  (b) 对于 $τ = 1$，画出一个具有 $M ≥ 3$ 个状态的遍历马尔可夫链的图（适用于任意 $M$ ），其中存在 $i, j$ 使 得当 $n = 2M − 3$ 时 $P^{n}_{ij} = 0$。
> (c) 对于任意 $τ < M − 1$，画出一个具有 $M$ 个状态的遍历马尔可夫链的图（适用于任意 $M$ ），其中存在 $i, j$ 使得当 $n = (M − 2)τ + M − 1$ 时 $P^n_{ij} = 0$。

## 3.6 课后习题


