> 何瑞杰
> 25110801
>1. 整理老师课堂上讲解的例题
>2. 完成讲义第3章 3.6节的剩余课后习题
> <font color="red">25/11/04 12:00截止</font>

---

## 3.4 


## 3.5 


## 3.6 



---

## 课后习题

### 5.

已知今天是多云，即 $x_{0} = [1, 0]$，则 $n$ 天后的天气状况分布为
$$
x_{n} = x_{0} P^{n}
$$
求 $P$ 的特征值和特征向量：$u_{1} = [1, 1]^{\top}$，$u_{2} = \left[ -\frac{3}{2}, 1 \right]$，分别对应 $\lambda_{1} = 1$，$\lambda_{2} = \frac{1}{6}$，因此有
$$
P = U \Lambda U^{-1}, \quad  \Lambda=\text{diag}\left\{  \frac{1}{6}, 1  \right\}, U = \begin{bmatrix}
-\frac{3}{2} & 1\\1 & 1
\end{bmatrix}
$$
于是
$$
P^{n} = U\Lambda^{n} U^{-1}, x_{n} = \left[ \frac{2^{n+1}\cdot {3}^{n} + 3}{5 \cdot 6^{n}}, \frac{3(6^{n}-1)}{5 \cdot 6^{n}} \right]
$$
分别代入 $n=3, 5, 10$，有
$$
\begin{align}
x_{3} &= \left[ \frac{2^{4}\cdot {3}^{n} + 3}{5 \cdot 6^{3}}, \frac{3(6^{3}-1)}{5 \cdot 6^{3}} \right]\\
x_{5} &= \left[ \frac{2^{6}\cdot {3}^{5} + 3}{5 \cdot 6^{5}}, \frac{3(6^{5}-1)}{5 \cdot 6^{5}} \right]\\
x_{10} &= \left[ \frac{2^{11}\cdot {3}^{10} + 3}{5 \cdot 6^{10}}, \frac{3(6^{10}-1)}{5 \cdot 6^{10}} \right]
\end{align}
$$
当 $n \rightarrow \infty$ 时，有 $x_{\infty} = \left[ \frac{2}{3}, \frac{1}{3} \right]$.

### 6. 
系统共有三个状态，（红，红），（红，蓝），（蓝，蓝）。可以列出其转移矩阵
$$
P = \begin{bmatrix}
0.8 & 0.2 & 0\\
0.1 & 0.8 & 0.1\\
0 & 0.2 & 0.8
\end{bmatrix}
$$
系统初始状态为 $S_{0} = [R, B]$，即 $x_{0}=[0, 1, 0]$。接下来计算拿出两个红球后袋中球色的概率分布。拿出第一个红球时，只可能再向袋中加入红球，因为第二次依然拿出的是红球。因此 $x_{1}=[0, 1, 0]$；第二次再拿出红球时同理，可得 $x_{2} = [0, 1, 0]$。在第五次抽取之前，有 $x_{4} = x_{2} P^{2} = [0.32, 0.68, 0.32]$。记 $X_{5}$ 为第五次拿出的球的颜色，第四次抽取后系统状态为 $S_{4}$，有
$$
\begin{align}
P(X_{5} = R|x_{4}) &= P(X_{5}=R|S_{4}=[R, R])P(S_{4}=[R, R]) + P(X_{5}=R|S_{4}=[R, B])P(S_{4}=[R, B])\\
&= 1 \cdot 0.32 + 0.5 \cdot 0.68 = 0.16 + 0.34 = 0.6.
\end{align}
$$

### 7. 
分配九次后恰好八个瓮中恰好三个不空，相当于先拿出三个球放在任选的三个不同的瓮中，剩下六个随意分配到这三个瓮中。
$$
P = {\binom{8}{3} \cdot 3^{6}} \Big/ {8^{9}} = \frac{244,944}{16,777,216}
$$

### 8. 
设 $X_{t}$ 为第 $t$ 次抛掷硬币的结果，然后记 $S_{t} = [X_{t-2}, X_{t-1}, X_{t}]$ 为系统状态。这是一个 Markov 链，有下面的转移概率：
$$
\begin{matrix}
[H, H, H]\\[0.2em]
[H, H, T]\\[0.2em]
[H, T, H]\\[0.2em]
[T, H, H]\\[0.2em]
[H, T, T]\\[0.2em]
[T, H, T]\\[0.2em]
[T, T, H]\\[0.2em]
[T, T, T]
\end{matrix}
\quad 
\begin{bmatrix}
\frac{1}{2} & \frac{1}{2}&0 &0 &0 &0 &0 &0\\
0 & 0& \frac{1}{2} & 0 & \frac{1}{2} &0 &0 &0\\
0 & 0&0 & \frac{1}{2} & 0 & \frac{1}{2} &0 &0\\
 \frac{1}{2} & \frac{1}{2} &0 &0 &0 &0 &0 &0\\
 0&0&0&0&0&0& \frac{1}{2} & \frac{1}{2}\\
 0&0& \frac{1}{2} & 0  & \frac{1}{2}& 0 & 0 & 0\\
 0 & 0 & 0 & \frac{1}{2} & 0 & \frac{1}{2} & 0 & 0\\
 0 & 0 & 0 & 0 & 0 & 0 & \frac{1}{2} & \frac{1}{2}
\end{bmatrix} = P ~ ~ ~\mathop{-\!\!\!-\!\!\!-\!\!\!\longrightarrow}\limits^{吸收态} 
\begin{bmatrix}
1 & 0 &0 &0 &0 &0 &0 &0\\
0 & 0& \frac{1}{2} & 0 & \frac{1}{2} &0 &0 &0\\
0 & 0&0 & \frac{1}{2} & 0 & \frac{1}{2} &0 &0\\
 \frac{1}{2} & \frac{1}{2} &0 &0 &0 &0 &0 &0\\
 0&0&0&0&0&0& \frac{1}{2} & \frac{1}{2}\\
 0&0& \frac{1}{2} & 0  & \frac{1}{2}& 0 & 0 & 0\\
 0 & 0 & 0 & \frac{1}{2} & 0 & \frac{1}{2} & 0 & 0\\
 0 & 0 & 0 & 0 & 0 & 0 & \frac{1}{2} & \frac{1}{2}
\end{bmatrix} = P
$$

令第 $t$ 次抛掷硬币后状态 $S_{t}$ 的分布为 $x_{t}$，显然有 $x_{3} = \frac{1}{8}[1, \dots, 1]$。由于 $[H, H, H]$ 是吸收态，只要计算 $x_{3}P^{5}$ 和 $x_{3}P^{7}$ 即可求得 $P(N \leqslant 8)$ 和 $P(N \leqslant 7)$。调用 `sympy` 库计算得到 $P(N \leqslant 7) = \frac{47}{128}$，$P(N \leqslant 8) = \frac{107}{256}$，因此有 $P(N=8) = \frac{13}{256}$。

### 9.
设置 $1$ 为吸收态，转移矩阵为
$$
P = \begin{bmatrix}
1 &0&0&0\\
1 / 3 & 0 & 1 / 3 & 1 / 3\\
1 / 3 & 1 / 3 & 0 & 1 / 3\\
0 & 1 / 6 & 1 / 3 & 1 / 2
\end{bmatrix}
$$
将每个状态分配 $1$ 的报酬，得到带有报酬的 Markov 链，设第 $i$ 个状态的报酬期望为 $v_i$，有
$$
\begin{align}
v_{2} &= 1 + P_{2,3} v_{3} + P_{2,4} v_{4}\\
v_{3} &= 1 + P_{3,2} v_{2} + P_{3,4} v_{4}\\
v_{4} &= 1 + P_{4,2}v_{2} + P_{2,3} v_{3} + P_{4,4} v_{4}\\
\end{align}
$$
解得 $v_{2} = v_{3} = 5$，$v_{4} = 7$，这是从 $2, 3, 4$ 状态出发首达 $1$ 的期望步数。

观察原转移矩阵，可得若从 $1$ 出发，$2$ 和 $3$ 是对称的，因此状态 $2$ 和状态 $3$ 的首达时间相同：
$$
\begin{align}
v_{1} &= 1 + P_{1,1}v_{1} + P_{1,3} v_{3}\\
v_{3} &= 1 + P_{3,1}v_{1} + P_{3,4} v_{4}\\
v_{4} &= 1 + P_{4,3}v_{3} + P_{4,4}v_{4}
\end{align}
$$
求解得到 $v_{1} = \frac{43}{11}$，因此状态 $2$ 的首发时间是 $\frac{43}{11}$。最后求解从 $1$ 出发首达 $4$ 的期望时间，还是和前面一样，有
$$
\begin{align}
v_{1} &= 1 + P_{1,1}v_{1} + P_{1,2} v_{2} + P_{1,3} v_{3}\\
v_{2} &= 1 + P_{2,1}v_{1} + P_{2,3} v_{3}\\
v_{3} &= 1 + P_{3,1}v_{1} + P_{3,2}v_{2}
\end{align}
$$
解得 $v_{1} = 7$，因此从 $1$ 出发首达 $4$ 的期望时间是 $7$。

### 10.
（1） 和 （2） 是公平的。
（3）注意要分出胜负，必须连续掷出两个 $H$，剩下掷出 $H$ 或 $T$ 的概率都是 $1/2$，因此公平
（4）考虑出现的模式：$\{ \varnothing, H, HH, HT, HHT, H T T \}$，可以得到一个 Markov 链，其将 $H H T$ 和 $H T T$ 变为吸收态的转移矩阵为
$$
P = \begin{bmatrix}
1/2 & 1 / 2  & 0 & 0 & 0 & 0\\
0 & 0 & 1 / 2 & 1/2 & 0 & 0\\
0 & 0 & 1/2 & 0 & 1 / 2 & 0 \\
0 & 1/2 & 0 & 0 & 0 & 1 / 2\\
0 & 0 & 0 & 0 & 1 & 0\\
0 & 0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$
设 $P_{\varnothing}$ 为从游戏开始计算，出现 $H H T$ 的概率（甲胜的概率），有
$$
\begin{align}
P_{\varnothing} &= \frac{1}{2} P_{\varnothing} + \frac{1}{2} P_{H}\\
P_{H} &= \frac{1}{2} P_{H H} + \frac{1}{2}P_{H T}\\
P_{H H} &= \frac{1}{2} P_{H H} + \frac{1}{2} \cdot 1\\
P_{H T} &= \frac{1}{2} P_{H} + \frac{1}{2} \cdot 0
\end{align}
$$
解得 $P_{\varnothing} = \frac{2}{3} > \frac{1}{2}$，因此甲更容易赢，游戏不公平。

### 11.
记家中的伞的数量为 Markov 链的状态，可得下面的 Markov 链：
![[Pasted image 20251104222804.png|1000]]
其中 $q = p(1-p)$。我们需要求的是此人某天出门时下雨且家中没有伞的概率，即 Markov 链的稳态概率。首先可得该链的转移矩阵
$$
P = \begin{bmatrix}
1-q & q & 0 & 0\\
q & 1-2q & q & 0\\
0 & q & 1-2q & q\\
& & \ddots & \ddots & \ddots \\
&&& q & 1-2q & q & 0\\
&&& 0 & q & 1-2q & q\\
&&& 0  & 0 & q & 1-q\\
\end{bmatrix}_{(M+1) \times (M+1)}
$$
注意到对于向量 $\displaystyle x = \frac{1}{M+1}[1, 1, \dots, 1] \in \mathbb{R}^{1 \times (M+1)}$，满足 $x P = x$，我们知道 $x$ 是 $P$ 的一个（左）特征向量、具有归一化性质，且对应的特征值为 $1$。因此 $x$ 是这个 Markov 链的一个稳态向量。所以此人从家出门且没带伞的概率为 $\displaystyle \frac{p}{M+1}$。

### 12.
这个 Markov 链的转移矩阵是循环矩阵。由于 $\sum\limits_{i} p_{i} = 1$，可得归一化特征向量为 $\displaystyle x = \frac{1}{m+1}[1, 1, \dots, 1]$，其特征值也为 $1$。因此 $\displaystyle \lim_{ n \to \infty } p_{i,j}^{n} = \frac{1}{m+1}$，平稳分布是均匀分布。

### 13.
(1)
据题意，$n-1$ 时刻中有 $i$ 个人积极，$N-i$ 个人消极；其中积极的人中有 $x$ 人变得消极，则消极的人中有 $j-i-x$ 人变得积极。这个变化过程与在 $n-1$ 时刻之前的积极消极人数分布无关。因此有
$$
P(X_{n}=j|X_{n-1}=i, \dots, X_{0} = l) = P(X_{n} = j | X_{n-1} = i) = \sum\limits_{k=0}^{\min\{ i, j \}} \binom{i}{k} \alpha^{1-x}(i-\alpha)^{x}  \binom{N-i}{j-k} \beta^{j-k}(1-\beta)^{j-i-(j-k)}   
$$
$X_{n}$ 是一个 Markov 链。

（2）
从每个人的状态来看，若用 $+$ 表示积极，$-$ 表示消极，它也是一个小的 Markov 链：
![[Pasted image 20251104232423.png|400]]
可得转移矩阵为
$$
P = \begin{bmatrix}
\alpha & 1-\alpha\\
\beta & 1 - \beta
\end{bmatrix}
$$
假设稳态时该人处于积极状态的概率为 $p$，则有
$$
p(1-\alpha) = (1-p)(1-\beta) \implies p = \frac{1-\beta}{2-\alpha - \beta}
$$

若 $n$ 足够大，其就不受 $0$ 时刻状态的影响：$\displaystyle \mathbb{E}[X_{n}|X_{0}=i] = \mathbb{E}[X_{n}] = N \cdot \frac{1-\beta}{2-\alpha-\beta}$

如果 $n$ 不够大，则有
$$
\mathbb{E}[X_{n}|X_{0} = i] = \sum\limits_{k=0}^{N} k P(X_{n}=k|X_{0}=i)
$$
然后利用 Chapman-Kolmogorov 方程求解。

（3）
$$
P(X_{n} = j | X_{n-1} = i) = \sum\limits_{k=0}^{\min\{ i, j \}} \binom{i}{k} \alpha^{1-x}(i-\alpha)^{x}  \binom{N-i}{j-k} \beta^{j-k}(1-\beta)^{j-i-(j-k)}  
$$
（4）
根据 (2) 过程中得到的结果，有积极人数占比 $\displaystyle \frac{1-\beta}{2-\alpha-\beta}$，消极人数占比 $\displaystyle \frac{1-\alpha}{2-\alpha-\beta}$






