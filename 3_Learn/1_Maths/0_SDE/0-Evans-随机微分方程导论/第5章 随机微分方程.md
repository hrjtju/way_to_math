
## 5.1 SDE 的定义和示例
### 5.1.1 前置知识

首先进行一些符号的约定。

> **记号约定 5.1**
> 记 $\boldsymbol{W}(\cdot)$ 是一个 $m$ 维 Brown 运动，$\boldsymbol{X}_{0}$ 是一个和 $\boldsymbol{W}(\cdot)$ 无关的 $n$ 维随机变量。定义 $\mathcal{F}(t)$ 由 Brown 运动直至时间 $t$ 的历史和 $\boldsymbol{X}_{0}$ 生成的 $\sigma$ 代数为
> $$\mathcal{F}(t) \coloneqq \mathcal{U}(\boldsymbol{W}(s)(0 \leqslant s \leqslant t), \boldsymbol{X}_{0}), \quad  t \geqslant 0$$

> **记号约定 5.2**
> 给定 $T > 0$，考虑函数 $\boldsymbol{b}: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{R}^{n}$，$\boldsymbol{B}: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{M}^{n \times m}$。我们常会以矩阵和向量的形式写出这些函数：
> $$\boldsymbol{b} = [b^{(1)}, b^{(2)}, \dots, b^{(n)}], \quad \quad \boldsymbol{B} = \begin{bmatrix} b^{(1, 1)} & \cdots & b^{(1, m)}\\ \vdots & \ddots & \vdots \\ b^{(n, 1)} & \cdots  & b^{(n, m)} \end{bmatrix}.$$

接着就可以给出 Ito SDE 的一般形式了。

> **定义 5.3（Ito 随机微分方程）**
> 对 $0 \leqslant t \leqslant T$ ，称 $n$ 维实向量值的随机过程 $\boldsymbol{X}(\cdot)$ 是下面的**Ito 随机微分方程** 的解
> $$\left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t) \mathrm{d} t + \boldsymbol{B}(\boldsymbol{X}, t) \mathrm{d}\boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right. $$
> 如果 $\boldsymbol{X}(\cdot)$ 满足下面四个条件：
> 1. $\boldsymbol{X}(\cdot)$ 是对 $\mathcal{F}(\cdot)$ 是循序可测的
> 2. $\boldsymbol{F} \coloneqq \boldsymbol{b}(\boldsymbol{X}, t) \in \mathbb{L}_{n}^{1}(0, T)$
> 3. $\boldsymbol{G} \coloneqq \boldsymbol{B}(\boldsymbol{X}, t) \in \mathbb{L}_{n \times m}^{2}(0, T)$
> 4. 对所有 $0 \leqslant t \leqslant T$，都有 $\displaystyle \boldsymbol{X}(t) = \boldsymbol{X}_{0} + \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}(s), s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}(s), s) \, \mathrm{d}\boldsymbol{W} \quad \text{a.s.}$

在条件（2）和（3）的保证下，我们可以假定 $\boldsymbol{X}(\cdot)$ 的采样路径几乎一定连续。

> **注释 5.4（高阶 SDE）**
> 一般将高阶 SDE 写成下面的形式
> $$Y^{(n)} = f(t, Y, \dots, Y^{(n-1)}) + g(t, Y, \dots, Y^{(n-1)}) \xi$$
> 本注释中 $\square^{(i)}$ 表示对函数的 $i$ 阶导，$\xi$ 是白噪声。我们可以用下面的方法将其写成我们熟悉的形式。只需令
> $$\boldsymbol{X}(t) = \begin{bmatrix}Y(t)\\ Y^{(1)}(t) \\ \vdots \\ Y^{(n-1)}(t)\end{bmatrix} = \begin{bmatrix}X_{1}(t)\\ X_{2}(t) \\ \vdots \\ X_{n}(t)\end{bmatrix}.$$
> 于是这个 SDE 可以写成
> $$\mathrm{d} \boldsymbol{X} = \begin{bmatrix}X^{2}\\ \cdots \\ f(\cdots)\end{bmatrix} + \begin{bmatrix}0 \\ \vdots  \\ g(\cdots )\end{bmatrix} \mathrm{d} W.$$

### 5.1.1 线性 SDE 的一些例子

> **示例 5.5** 
> 
> 令 $m=n=1$，考虑确定的连续函数 $g$，随机微分方程
> $$\left\{ \begin{align}\mathrm{d} X &= gX\mathrm{d} W\\X(0) &= 1\end{align} \right. $$
> 的解为 $\displaystyle X(t) = \exp \left\{ -\frac{1}{2}\int_{0}^{t} {g^{2}} \, \mathrm d{s} + \int_{0}^{t} {g} \, \mathrm d{W} \right\}$

验证方法不难，令 $\displaystyle Y(t) = -\frac{1}{2} \int_{0}^{t} {g^{2}} \, \mathrm d{s} + \int_{0}^{t} {g} \, \mathrm d{W}$，它满足随机微分 $\displaystyle \mathrm{d}Y = -\frac{1}{2} g^{2} \mathrm{d}t + g \mathrm{d} W$。令 $X = e^{Y} = u(Y)$，根据 Ito 链式法则，有
$$
\begin{align}
\mathrm{d}X &= \mathrm{d}u(Y) =\left( u_{t} + u_{x} F + \frac{1}{2}u_{x x} G^{2} \right)\mathrm{d} t + u_{x} G \mathrm{d} W\\
&= \left( 0 - \frac{1}{2}e^{Y}g^{2} + \frac{1}{2}e^{Y}g^{2} \right)\mathrm{d}t + e^{Y} g \mathrm{d} W\\
&= e^{Y} g \mathrm{d}W = gX \mathrm{d}W.
\end{align}
$$

> **示例 5.6** 
> 
> 和上例类似，方程
> $$\left\{ \begin{align}\mathrm{d} X &= fX \mathrm{d}t + gX \mathrm{d} W\\ X(0) &= 1\end{align} \right. $$
> 的解为 $\displaystyle X(t) = \exp \left\{ \int_{0}^{t} {f - \frac{1}{2}g^{2}} \, \mathrm d{s} + \int_{0}^{t} {g} \, \mathrm d{W} \right\}$

要验证这个结果，同样令 $\displaystyle Y(t) = \int_{0}^{t} {f - \frac{1}{2}g^{2}} \, \mathrm d{s} + \int_{0}^{t} {g} \, \mathrm d{W}$，它满足随机微分 $\mathrm{d} Y = \displaystyle \left( f - \frac{1}{2g^{2}} \right)\mathrm{d}t + g\mathrm{d}W$，由 Ito 链式法则，有
$$ \begin{align} \mathrm{d}X&=\mathrm{d}u(Y) = \mathrm{d}e^{Y}\\ &= \left[ e^{Y}\left( f - \frac{1}{2}g^{2} \right) + \frac{1}{2} g^{2} \right]\mathrm{d}t + e^{Y}g \mathrm{d}W\\ &= fX \mathrm{d}t + g X \mathrm{d} W \end{align}$$

> **示例 5.7（股价）** 
> 
> 定义某支股票在 $t$ 时刻的价格为 $S(t)$。我们可以用下面的 SDE 建模股价的瞬时变化率为 $\displaystyle \frac{\mathrm{d} S}{S}$：
> $$\frac{\mathrm{d} S}{S} = \mu \mathrm{d} t + \sigma \mathrm{d} W \implies \left\{ \begin{align} \mathrm{d} S &= \mu S \mathrm{d} t + \sigma S \mathrm{d} W\\ S(0) &= s_{0} \end{align} \right. $$
> 其中 $\mu>0$ 和 $\sigma$ 是常数，分别成为股票的漂移和波动。

如果考虑 $u(S) = \log S$，用 Ito 链式法则，有
$$
\begin{align}
\mathrm{d} (\log S) &= \left( 0 + {\color{blue} \frac{1}{S} \cdot \mu S} \,{\color{red} - \frac{1}{2 S^{2}}\sigma^{2} S^{2}} \right) \mathrm{d}t + {\color{blue} \frac{1}{S} \cdot \sigma S \mathrm{d}W}\\
&= \frac{\color{blue} \mathrm{d} S}{S}\, {\color{red} - \frac{1}{2 S^{2}}\sigma^{2} S^{2}} \mathrm{d}t\\
&= \left( \mu - \frac{1}{2}\sigma^{2} \right)\mathrm{d} t + \sigma \mathrm{d}W
\end{align}
$$
因此我们可以立刻得到 $\displaystyle S(t) = s_{0}\exp \left\{ \sigma W(t) + \left[ \mu - \frac{\sigma^{2}}{2} \right]t \right\}$.

其中关于上面推导的第二步，我们可以考虑一般的情形，$\mathrm{d}X = F \mathrm{d} t + G \mathrm{d} W$，$u(\cdot)$ 是二次可导的函数，即
$$
\begin{align}
\mathrm{d}u(X) &= \left( u_{x} F + \frac{1}{2}u_{x x}G^{2} \right) \mathrm{d} t + u_{x} G \mathrm{d}W\\
&= u'({\color{red} F \mathrm{d} t + G \mathrm{d} W}) + \frac{1}{2} u'' G^{2} \mathrm{d}t\\
&= u'\mathrm{d} X + \frac{1}{2} u'' G^{2} \mathrm{d}t
\end{align}
$$
另外，从上面的 SDE，我们也能得到
$$
S(t) = s_{0} + \int_{0}^{t} {\mu S} \, \mathrm d{s} + \int_{0}^{t} {\sigma S} \, \mathrm d{W} 
$$
因为最后一项的期望为零，我们能得到
$$
E(S(t)) = s_{0} + \int_{0}^{t} {\mu E(S(s))} \, \mathrm d{s} \implies f(t) = f_{0} + \mu\int_{0}^{t} {f(s)} \, \mathrm d{s} 
$$
两边对 $t$ 求导，得到 $f'(t)=\mu f(t)$，因此有 $f(t) = E(S(t)) =  s_{0}e^{\mu t}$。如果上文一般情况中令波动系数 $\sigma \rightarrow 0$，就与上面的结果对应。

> **示例 5.8（Brown 桥）** 
> 
> 考虑下面的 SDE
> $$\left\{ \begin{align}\mathrm{d} B &= - \frac{B}{1-t} \mathrm{d}t + \mathrm{d} W\\B(0) &= 0\end{align} \right. \quad 0 \leqslant t \leqslant 1$$
> 它的解为
> $$B(t) = (1-t)\int_{0}^{t} {\frac{1}{1-s}} \, \mathrm d{W} $$
> 且满足 $\displaystyle \lim_{ t \to 1^{-} } B(t) = 0\quad \text{a.s.}$ 我们称 $B(\cdot)$ 是 $0$ 时刻到 $1$ 时刻的原点之间的 Brown 桥。

> **示例 5.9（Langevin 等式）** 
> 
> 我们可以将摩擦力考虑进来，以更精细地建模先前的 Brown 分子运动模型。考虑一维的情况
> $$\dot{X} = -bX + \sigma \xi$$
> 其中 $\xi$ 是白噪声，$b$ 是摩擦系数，$\sigma$ 是扩散参数。我们可以将其写成下面的 SDE 模型
> $$\left\{ \begin{align} \mathrm{d} X &= -b X \mathrm{d}t + \sigma \mathrm{d} W\\ X(0) &= X_{0} \end{align} \right. $$
> 我们可以将 $X(\cdot)$ 理解为粒子的速度，和下一个例子中的位置过程 $Y(\cdot)$ 对应。

该方程的解为
$$
X(t) = e^{-bt} X_{0} + \sigma \int_{0}^{t} {e^{-b(t-s)}} \, \mathrm d{W}, \quad t \geqslant 0 .
$$

另外注意 $X$ 满足对应下面积分形式的随机微分
$$
X(t) = X(0) -b\int_{0}^{t} {X}(s) \, \mathrm d{s} + \sigma W(t) \implies E(X(t)) = E(X(0)) - b\int_{0}^{t} {E(X(s))} \, \mathrm d{s} + 0 
$$
我们立即得到 $E(X(t)) = E(X_{0})e^{-bt}$。然后计算二阶距：
$$
\begin{align}
E(X^{2}(t)) &= E\left[ e^{-2bt} X_{0}^{2} + 2\sigma e^{-bt}X_{0} \int_{0}^{t} {e^{-b(t-s)}} \, \mathrm d{W} + \sigma^{2}{\color{red} \left( \int_{0}^{t} {e^{-b(t-s)}} \, \mathrm d{W}  \right)^{2}} \right]\\
&= e^{-2bt} E(X_{0}^{2}) + 2\sigma e^{-bt}E(X_{0}){\color{blue} E\left( \int_{0}^{t} {e^{-b(t-s)}} \, \mathrm d{W}  \right)} + \sigma^{2} {\color{red} \int_{0}^{t} {e^{-2b(t-s)}} \, \mathrm d{s} } & E\left( \int_{0}^{t} {G} \, \mathrm d{W}  \right)^{2}=\int_{0}^{t} {G^{2}} \, \mathrm d{s} \\
&= e^{-2bt} E(X_{0}^{2}) + \sigma^{2}\int_{0}^{t} {e^{-2b(t-s)}} \, \mathrm d{s} & E\left( \int_{0}^{t} {G} \, \mathrm d{W}  \right) = 0\\
&= e^{-2bt} E(X_{0}^{2}) + \frac{\sigma^{2}}{2b}(1 - e^{-2bt})
\end{align}
$$
于是得到方差 $V(X(t)) = E(X^{2}(t)) - E(X(t))^{2} = e^{-2bt}V(X_{0}) + \displaystyle \frac{\sigma^{2}}{2b}(1 - e^{-2bt})$。此时我们关注该过程之均值和方差的渐近性质，假设 $V(X_{0}) < \infty$，当 $t \rightarrow \infty$ 时，有
$$
\begin{align}
E(X(t)) &\rightarrow 0\\
V(X(t)) &\rightarrow \displaystyle \frac{\sigma^{2}}{2b}
\end{align}
$$
换言之，粒子的分布在 $t$ 充分大时趋近于 $\displaystyle N\left( 0, \frac{\sigma^{2}}{2b} \right)$，这是一个固定的分布。它的方差项同时包含扩散系数和摩擦系数，可以将其理解为时间充分大后扩散与摩擦耗散之间的平衡。

<center><img src="Pasted%20image%2020251115225358.png" alt="Langevin 方程的模拟" style="zoom:60%"></center>

<center>Langevin 方程的模拟</center>

> **示例 5.10（Ornstein-Uhlenbeck 过程, OU 过程）** 
> 
> 一个更好的建模 Brown 运动的模型由下面的 Ornstein-Uhlenbeck 方程给出：
> $$\left\{ \begin{align} \ddot{Y} &= -b \dot{Y} + \sigma \xi\\ Y(0) &= Y_{0}\\ \dot{Y}(0) &= Y_{1} \end{align} \right. $$

若令 $X = \dot{Y}$，原方程就转变为我们刚刚见过的形式：
$$
\begin{align}
\mathrm{d}X &= -bX \mathrm{d}t + \sigma \mathrm{d} W\\
X(0) &= Y_{1}
\end{align}
$$
假设 $Y_{1}$ 服从 Gauss 分布，有
$$
X(t) = e^{-bt}Y_{1} + \sigma \int_0^{t} e^{-b(t-s)} \, \mathrm d{W} 
$$
也服从 Gauss 分布（不严谨的说，第一项服从 Gauss 分布，第二项是对 Gauss 分布的加权和）。接着我们计算 $Y(t)$ 的均值和方差：
$$
\begin{align}
E(Y(t)) &= E(Y_{0}) + E\left[ \int_{0}^{t} {X} \, \mathrm d{s}  \right]\\
&= E(Y_{0}) + \int_{0}^{t} {E(X(s))} \, \mathrm d{s} \\
&= E(Y_{0}) + \int_{0}^{t} {E\left[ e^{-bt}Y_{1} + \sigma \int_0^{t} e^{-b(t-s)} \, \mathrm d{W} \right]} \, \mathrm d{s} \\
&= E(Y_{0}) + \int_{0}^{t} {e^{-bt}E[Y_{1}]} \, \mathrm d{s} = E(Y_{0}) + \frac{E(Y_{1})(1-e^{-bt})}{b}
\end{align}
$$
经过一些复杂计算，我们可以得到方差
$$
V(Y(t)) = V(Y_{0}) + \frac{\sigma^{2}}{b^{2}}t + \frac{\sigma^{2}}{2b^{3}}(-3 + 4 e^{-bt} - e^{-2bt})
$$


> **示例 5.11（随机谐振子）**
> 
> 描述随机谐振子的方程如下所示
> $$\left\{ \begin{align}\ddot{X} &= -\lambda^{2}X - b\dot{X} + \sigma \xi\\ X(0) &= X_{0} \\ \dot{X}(0) &= X_{1}\end{align} \right. $$
> 其中 $-\lambda^{2}X$ 表示线性的回复力，$-b \dot{X}$ 表示摩擦力。

该方程的解析解可以由 5.4 节中的一般性公式得出。对于 $X_{1}=0, b=0, \sigma=1$ 的特殊情形，有下面的解
$$
X(t) = X_{0}\cos (\lambda t) + \frac{1}{\lambda} \int_{0}^{t} {\sin(\lambda(t-s))} \, \mathrm d{W} 
$$

## 5.2 解的存在性和唯一性

本节介绍构造 SDE 解的方法，先从最简单的一维例子开始

### 5.2.1 一维解的构造

现假设函数 $b: \mathbb{R} \rightarrow \mathbb{R}$ 是 $\mathscr{C}^{1}$ 的，并存在某个 $L$ 使得其导数 $|b'| \leqslant L$。考虑下面的 SDE
$$
\left\{ \begin{align}
\mathrm{d} X &= b(X) \mathrm{d} t + \mathrm{d} W\\
X(0) &= x_{0} \in \mathbb{R}
\end{align} \right.
$$
根据前文的介绍，这个 SDE 的表示
$$
X(t) = x_{0} + \int_{0}^{t} b(X) \,\mathrm{d} s + W(t), \quad t > 0
$$
读者不难发现，等式右侧也是 $X$ 的一个函数，这构成了一个 “不动点” 形式。因此我们考虑从一个 $X_{0}$ 出发，不断用等式右边去作用，看看能不能收敛到满足 SDE 的解。令 $X^{(0)}(t)\equiv X_{0}$，然后执行下面的迭代：
$$
X^{(k+1)}(t) \coloneqq x_{0} + \int_{0}^{t} b(X^{(k)}) \, \mathrm{d}s + W(t), \quad  k=0, 1, \dots ; t \geqslant 0
$$
对 $X^{(1)}$ 和 $X^{(0)}$，我们有
$$
D^{(0)}(t) \coloneqq \max\limits_{0 \leqslant s \leqslant t}~|X^{(1)}(s) - X^{(0)}(s)|= \max\limits_{0 \leqslant s \leqslant t}~\left| \int_{0}^{s} b(x) \mathrm{d} r + W(s, \omega) \, \mathrm{d}  \right| \leqslant C(\omega), \quad 0 \leqslant t \leqslant T
$$
其中 $C(\omega)$ 是关于概率空间中点 $\omega$ 的常数。我们现在**断言**
$$
D^{(k)}(t) \leqslant C \cdot \frac{L^{k}}{k!} \cdot t^{k}, k = 0, 1, \dots; 0 \leqslant t \leqslant T
$$
下面用归纳法证明。首先当 $k=0$ 时，显然成立。假设 $k-1$ 时断言成立，现在考虑 $D^{(k)}$：
$$
\begin{align}
D^{(k)}(t) &\coloneqq \max\limits_{0 \leqslant s \leqslant t}~|X^{(k+1)}(s) - X^{(k)}(s)|\\
&= \max\limits_{0 \leqslant s \leqslant t}~\left| \int_{0}^{s} b(X^{(k)}) - b(X^{(k-1)}) \, \mathrm{d} r \right| \\
&\leqslant \max\limits_{0 \leqslant s \leqslant t}~\int_{0}^{s} {\color{blue} |b(X^{(k)}) - b(X^{(k-1)})|} \, \mathrm{d} r \\
&\leqslant {\color{blue} L}{\color{red}\max\limits_{0 \leqslant s \leqslant t}}~ \int_{0}^{s} {\color{red} |X^{(k)} - X^{(k-1)}|} \, \mathrm{d} r & 0 \leqslant |b'| \leqslant L\\
&= L \int_{0}^{\color{red} t} |X^{(k)} - X^{(k-1)}| \, \mathrm{d} r & |\cdot| \geqslant 0\\
&\leqslant L \int_{0}^{t} \max\limits_{0 \leqslant \tau \leqslant r}|X^{(k)} - X^{(k-1)}| \, \mathrm{d} r\\
&= L \int_{0}^{t} D^{(k-1)}(r) \, \mathrm{d} r\\
&= L \int_{0}^{t}C \cdot \frac{L^{k-1}}{(k-1)!} \cdot r^{k-1} \, \mathrm{d} r & 归纳假设\\
&= C \cdot \frac{L^{k}t^{k}}{k!}
\end{align}
$$
我们注意到因为 $\displaystyle k! \sim \sqrt{ 2\pi k }\left( \frac{k}{e} \right)^{k}$，显然比 $M^{k}$ 高阶，当 $k \rightarrow \infty$ 时，有 $\displaystyle \frac{CL^{k}t^{k}}{k!} \rightarrow 0$。因此考虑某个正数 $n$ 和 $l \geqslant k \geqslant n$，当 $n \rightarrow \infty$ 时，有
$$
\begin{align}
\max\limits_{0 \leqslant t \leqslant T}~|X^{(l)}(t) - X^{(k)}(t)| \leqslant \sum\limits_{i=k}^{l-1} D^{(i)}(T) \leqslant \sum\limits_{i=k}^{\infty} D^{(i)}(T) \leqslant C\sum\limits_{i=k}^{\infty} \frac{L^{j}T^{j}}{j!} \rightarrow  0
\end{align}
$$
我们得到 $X^{(k)}$ 是一个 Cauchy 列。因此对几乎所有 $\omega$，$X^{(k)}$ 一致收敛于某个极限 $X$，后者恰好是 SDE 的解。

### 5.2.2 变量替换法

考虑下面形式的 SDE
$$
\left\{ \begin{align}
\mathrm{d} X &= b(X) \mathrm{d} t + {\color{red} \sigma(X) \mathrm{d} W}\\
X(0) &= x_{0}
\end{align} \right. 
$$
我们先解下面的简化形式
$$
\left\{ \begin{align}
\mathrm{d} Y &= f(Y) \mathrm{d} t + {\color{red} \mathrm{d}W}\\
Y(0) &= y_{0}
\end{align} \right. 
$$
我们将在后面介绍如何选取这个 $f$，得到这个简化 SDE 解后我们再找某个函数，使得 $X = u(Y)$来得到原来 SDE 的解。

假设 $u$ 已知，根据 Ito 链式法则，有
$$
\mathrm{d}X = \mathrm{d} u(Y) = \left[ u'f + \frac{1}{2} u'' \right] \mathrm{d}t + u' \mathrm{d} W
$$
因此如果 $\displaystyle u'(Y)f(Y) + \frac{1}{2}u''(Y) = b(X) = b(u(Y))$、$\displaystyle u'(Y) = \sigma(X) = \sigma(u(Y))$ 以及 $u(y_{0}) = x_{0}$，就可以得出原 SDE 的解。

我们可以先解出不含有 $f$ 的部分，也就是下面的 ODE：
$$
\left\{ 
\begin{align}
u'(z) &= \sigma(u(z))\\
u(y_{0}) &= x_{0}
\end{align}
\right. \quad \quad z \in \mathbb{R}
$$
其中 $\square'$ 表示对 $z$ 求导。解出 $u$ 后，定义
$$
f(z) \coloneqq \frac{1}{\sigma(u(z))} \left[ b(u(z)) - \frac{1}{2}u''(z) \right] 
$$
我们不深入讨论涉及上面内容的细节。

### 5.2.3 一般的存在性和唯一性定理

我们先证明一个引理工具。

> **引理 5.12（Gronwall 不等式）**
> 
> 考虑定义在 $[0, T]$ 上的两个非负连续函数 $f$ 和 $\phi$ 和某个非负常数 $C_{0}$，若 $f$ 和 $\phi$ 满足对所有的 $t \in [0, T]$，都有 $$\phi(t) \leqslant C_{0} + \int_{0}^{t} f\phi \, \mathrm{d}s  $$则它们满足下面的不等式 $$\phi(t) \leqslant C_{0} \exp \left\{ \int_{0}^{t} f \, \mathrm{d}s  \right\} $$

**证明**.
令 $\displaystyle \Phi = C_{0} + \int_{0}^{t} f\phi \, \mathrm{d}s$，则有 $\Phi' = f\phi$。由定理条件，$\phi \leqslant \Phi$，且 $f, \phi \geqslant 0$，因此有 $\Phi' = f\phi \leqslant f \Phi$。考虑
$$
g'(t) = \left[ \exp\left\{  -\int_{0}^{t} f \, \mathrm{d}s   \right\}\Phi \right]' = (\underbrace{ {\color{red} \Phi' - f\Phi} }_{ \leqslant\;\! 0 })\exp\{ * \} \leqslant 0.
$$
因此 $g$ 在定义域上是单调递减的，于是有
$$
g(t) = \exp\left\{  -\int_{0}^{t} f \, \mathrm{d}s   \right\}\Phi(t) \leqslant \Phi(0) = g(0) = C_{0} \iff \phi(t) \leqslant \Phi(t) \leqslant C_{0} \exp \left\{ \int_{0}^{t} f \, \mathrm{d}s  \right\}.
$$

接下来就可以证明我们的目标了

> **定理 5.13（SDE 解的存在性和唯一性）**
> 
> 考虑满足下列条件的连续函数 $\boldsymbol{b}: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{R}^{n}$ 和 $\boldsymbol{B}: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{M}^{m \times n}$：$$\begin{align}\|\boldsymbol{b}(\boldsymbol{x}, t) - \boldsymbol{b}(\hat{\boldsymbol{x}}, t)\| &\leqslant L\|\boldsymbol{x} - \hat{\boldsymbol{x}}\| \\ \|\boldsymbol{B}(\boldsymbol{x}, t) - \boldsymbol{B}(\hat{\boldsymbol{x}}, t)\| &\leqslant L\|\boldsymbol{x} - \hat{\boldsymbol{x}}\| \\[2em] \|\boldsymbol{b}(\boldsymbol{x}, t)\| &\leqslant L(1 + \|\boldsymbol{x}\|) \\ \|\boldsymbol{B}(\boldsymbol{x}, t)\| &\leqslant L(1 + \|\boldsymbol{x}\|) \\ \end{align}\quad \quad \text{for all } \quad 0 \leqslant t \leqslant T; \quad  \boldsymbol{x} , \hat{\boldsymbol{x}} \in \mathbb{R}^{n}$$  $m$ 维 Brown 运动 $\boldsymbol{W}(\cdot)$ 和 $\mathcal{W}^{+}(0)$ 独立，并满足下列条件的 $\mathbb{R}^{n}$ 值随机变量 $\boldsymbol{X}_{0}$ $$E(\|\boldsymbol{X}_{0}\|^{2}) < \infty,$$ 下面形式的 SDE 存在一个唯一解 $\boldsymbol{X} \in \mathbb{L}^{2}_{n}(0, T)$：$$\left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t) \mathrm{d} t + \boldsymbol{B}(\boldsymbol{X}, t) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right. \quad \quad 0 \leqslant t \leqslant T $$
> 注1. 唯一指的是在概率 $1$ 意义下唯一：如果有两个有几乎必然连续采样轨道的解 $\boldsymbol{X}, \hat{\boldsymbol{X}} \in \mathbb{L}_{n}^{2}(0, T)$ ，那么有 $$P(\boldsymbol{X}(t) = \hat{\boldsymbol{X}}(t)\; \text{for all }0 \leqslant t \leqslant T) = 1$$
> 注2. 对于 $\boldsymbol{B}$ 和 $\boldsymbol{b}$ 的前两条假设说的是它们对 $\boldsymbol{x}$ 是一致 Lipschitz 连续的。

**证明**.

**第一步：唯一性**

我们的思路是假设有两个有几乎一定连续轨道的解，然后证明它们在概率 $1$ 意义下相等。假设 $\boldsymbol{X}$ 和 $\hat{\boldsymbol{X}}$ 都是上述 SDE 的解，则对所有 $0 \leqslant t \leqslant T$，都有
$$
\boldsymbol{X}(t) - \hat{\boldsymbol{X}}(t) = \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}, s) - \boldsymbol{b}(\hat{\boldsymbol{X}}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) - \boldsymbol{B}(\hat{\boldsymbol{X}}, s) \, \mathrm{d}\boldsymbol{W}  
$$
我们对差的期望做估计。对任意 $0 \leqslant t \leqslant T$，有：
$$
\begin{align}
E(\|\boldsymbol{X}(t) - \hat{\boldsymbol{X}}(t)\|^{2}) &\leqslant 2E\left( \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}, s) - \boldsymbol{b}(\hat{\boldsymbol{X}}, s) \, \mathrm{d} s \right\|^{2}  \right) \\ & \quad + 2E\left( \left\| \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) - \boldsymbol{B}(\hat{\boldsymbol{X}}, s) \, \mathrm{d} \boldsymbol{W} \right\|^{2} \right) & 基本不等式\\
&\leqslant 2 t E\left(  \int_{0}^{t}\left\| \boldsymbol{b}(\boldsymbol{X}, s) - \boldsymbol{b}(\hat{\boldsymbol{X}}, s) \right\|^{2} \, \mathrm{d} s  \right) & \text{Cauchy-Schwarz 不等式} \\ & \quad + 2 E\left(  \int_{0}^{t}\left\| \boldsymbol{B}(\boldsymbol{X}, s) - \boldsymbol{B}(\hat{\boldsymbol{X}}, s) \right\|^{2} \, \mathrm{d} s \right) & \text{It$\hat{\mathrm{o}}$等距}\\
&\leqslant 2TL^{2} \int_{0}^{t} E(\|\boldsymbol{X} - \hat{\boldsymbol{X}}\|^{2}) \, \mathrm{d}s + 2L^{2}\int_{0}^{t} E(\|\boldsymbol{X} - \hat{\boldsymbol{X}}\|^{2}) \, \mathrm{d}s & \boldsymbol{b} \text{ 和 } \boldsymbol{B} \text{ 一致 Lipschitz 连续}\\
&= C \int_{0}^{t} E(\|\boldsymbol{X} - \hat{\boldsymbol{X}}\|^{2}) \, \mathrm{d}s 
\end{align}
$$
此时我们令 $\phi(t) = E(\|\boldsymbol{X}(t) - \hat{\boldsymbol{X}}(t)\|^{2})$，就得到 $\phi(t) \leqslant 0 + C \displaystyle \int_{0}^{t} \phi(s) \, \mathrm{d}s$ 根据上面的 Gronwall 不等式，$\phi(t) \leqslant 0$，因此只有 $\phi(t) = 0$。因此对所有 $0 \leqslant t \leqslant T$，都有 $\boldsymbol{X} = \hat{\boldsymbol{X}}$ 几乎处处成立。又由于 $\boldsymbol{X}$ 和 $\hat{\boldsymbol{X}}$ 的轨道几乎处处连续，就有
$$
\begin{align}
P\Big(\max\limits_{0 \leqslant t \leqslant T}~\|\boldsymbol{X}(t) - \hat{\boldsymbol{X}}(t)\| > 0\Big) = 0.
\end{align}
$$

**第二步：存在性**

我们再使用先前的方法，考虑下面的迭代：
$$
\left\{ \begin{align}
\boldsymbol{X}^{(0)}(t) &\coloneqq \boldsymbol{X}_{0}\\
\boldsymbol{X}^{(k+1)}(t) &\coloneqq \boldsymbol{X}_{0} + \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}(s), s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}(s), s) \, \mathrm{d}\boldsymbol{W},  
\end{align} \right. 
$$
其中 $k = \{ 0, 1, \dots \}$、$0 \leqslant t \leqslant T$。**我们要证明 $\boldsymbol{X}^{(k)}$ 在 $[0, T]$ 上几乎必然收敛到 $\mathbb{L}_{n}^{2}([0, T])$ 中。**

首先定义相邻两项 $\boldsymbol{X}^{(k+1)}$ 和 $\boldsymbol{X}^{(k)}$ 之间的距离为
$$
d^{(k)}(t) \coloneqq E\big[ \left\| \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\| ^{2} \big] 
$$
我们断言 $\displaystyle d^{(k)}(t) \leqslant \frac{(Mt)^{k+1}}{(k+1)!}$。首先对于 $k = 0$，有
$$
\begin{align}
d^{(0)}(t) &= E\big[ \left\| \boldsymbol{X}^{(1)}(t) - \boldsymbol{X}^{(0)}(t) \right\| ^{2} \big] \\

&= E\left[  \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}_{0}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}_{0}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2}  \right]\\

&\leqslant 2E\left[  \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}_{0}, s) \, \mathrm{d}s \right\|^{2}  \right] + 2E\left[  \left\| \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}_{0}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2}  \right] \\

&\leqslant 2E\left[  \left\| \int_{0}^{t} L(1 + \left\| \boldsymbol{X}_{0} \right\| ) \, \mathrm{d}s \right\|^{2}  \right] + 2E\left[ \int_{0}^{t} \boldsymbol{B}^{2}(\boldsymbol{X}_{0}, s) \, \mathrm{d}s   \right] & \text{线性增长条件，It$\hat{\mathrm{o}}$等距}\\

&\leqslant 2E\left[  \left\| \int_{0}^{t} L(1 + \left\| \boldsymbol{X}_{0} \right\| ) \, \mathrm{d}s \right\|^{2}  \right] + 2E\left[ \int_{0}^{t} L^{2}(1 + \left\| \boldsymbol{X}_{0} \right\| )^{2} \, \mathrm{d}s   \right] & \text{线性增长条件}\\
&\leqslant 2t(C_{1} + C_{2}) = tM.
\end{align}
$$
这就证明了 $k=0$ 的情况。接下来做归纳法，假设断言在 $k-1$ 时候成立，现在估计 $d^{(k)}$：
$$
\begin{align}
d^{(k)}(t) &= E\big[ \left\| \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\| ^{2} \big] \\
&= E\left[  \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2}  \right]
\\
&\leqslant 2{\color{red}E\left[  \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}s \right\|^{2}  \right]  }  + 2{\color{blue} E\left[  \left\| \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2}  \right]  } 
\\
&\leqslant 2{\color{red} t } E\left[ \int_{0}^{t} {\color{red} \left\| \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s)\right\|^{2}  }   \, \mathrm{d}s  \right] + 2E\left[   \int_{0}^{t} {\color{blue} \left\| \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s)\right\|^{2} \, \mathrm{d}s } \right] &  {{\color{red}\scriptstyle  \text{Cauchy-Schwartz 不等式} }}\atop{\scriptstyle {\color{blue} \text{It$\hat{\mathrm{o}}$等距} }}  
\\
&\leqslant 2TE\left[   \int_{0}^{t} L^{2}\left\|\boldsymbol{X}^{(k)} - \boldsymbol{X}^{(k-1)}\right\|^{2} \, \mathrm{d}s  \right] + 2E\left[  \int_{0}^{t}  L^{2}\left\|\boldsymbol{X}^{(k)} - \boldsymbol{X}^{(k-1)}\right\|^{2}  \, \mathrm{d}s \right] & \text{Lipschitz 条件}
\\
&\leqslant 2L^{2}(1+T) \int_{0}^{t} \frac{M^{k}s^{k}}{k!} \, \mathrm{d}s & \text{归纳假设} \\
&\leqslant \frac{M^{k+1}s^{k+1}}{(k+1)!}. & \text{考虑足够大的 }M
\end{align}
$$
这样就证明了 $\displaystyle d^{(k)}(t) \leqslant \frac{(Mt)^{k+1}}{(k+1)!}$。接下来我们要证明 $\boldsymbol{X}^{(k)}$ 在 $[0, T]$ 上几乎一定一致收敛，就需要证明
$$
P\left[ \max\limits_{t \in [0, T]}~\left\|  \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\|^{2} > \frac{1}{2^{k}} \text{ i.o.}\right] = 0.
$$
首先尝试对 $\displaystyle \max\limits_{t \in [0, T]}~\left\|  \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\|^{2}$ 的期望做估计，这一次我们对通常积分做和上面一样的放缩，但在期望里面多了一个 $\max$，不能使用 Ito 等距，由于 Brown 运动是一个鞅，随机积分那一项就可以用鞅不等式放缩
$$
\begin{align}
&~ ~E\left[ \max\limits_{t \in [0, T]}\left\|  \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\| \right]  \\&= E\left[  \max\limits_{t \in [0, T]}\left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2}\right] \\
&\leqslant {\color{gray} 2E\left[ \max\limits_{t \in [0, T]}\left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}s\right\|^{2} \right] } {\color{gray}+ 2E\left[ \max\limits_{t \in [0, T]}\left\|\int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s) \, \mathrm{d}\boldsymbol{W}  \right\|^{2} \right] }  \\
&\leqslant  2E\left[ \max\limits_{t \in [0, T]}t \int_{0}^{t} \|\boldsymbol{b}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{b}(\boldsymbol{X}^{(k-1)}, s)\|^{2} \, \mathrm{d}s \right] + 8 \int_{0}^{T} E\left[\|\boldsymbol{B}(\boldsymbol{X}^{(k)}, s) - \boldsymbol{B}(\boldsymbol{X}^{(k-1)}, s)\|^{2} \right] \, \mathrm{d}s & 鞅不等式   \\
&\leqslant 2{\color{red} T}L^{2} \int_{0}^{\color{red}T} E\Big[\| \boldsymbol{X}^{(k)} - \boldsymbol{X}^{(k-1)}\|^{2}\Big] \,\mathrm{d} s + 8L^{2} \int_{0}^{T} E\Big[ \big\| \boldsymbol{X}^{(k)} - \boldsymbol{X}^{(k-1)}\big\|^{2} \Big]  \, \mathrm{d} s \\
&= (2T+8)L^{2}\int_{0}^{T} d^{(k-1)}(s) \, \mathrm{d}s \leqslant (2T+8)L^{2} \int_{0}^{T} \frac{M^{k}}{k!} s^{k} \, \mathrm{d}s \\
&= \frac{2(T+4)M^{k}T^{k+1}}{(k+1)!} = C \frac{M^{k}T^{k}}{k!}.
\end{align}
$$
我们此时想计算 $\displaystyle P\left(\max\limits_{t \in [0, T]}~\left\|  \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\|^{2} > \frac{1}{2^{k}}\right)$ （记括号中为事件 $A_{k}$）的上界，这是为了凑一个收敛的级数，就可以使用 Borel-Cantelli 定理。注意 $\max \|\cdot\|$ 是一个凸函数，由鞅的线性性，$\boldsymbol{X}^{(k+1)} - \boldsymbol{X}^{(k)}$ 是一个鞅，于是被凸函数 $\max \|\cdot\|$ 作用后得到一个下鞅，就可以使用下鞅的不等式 
$$
P\Big(\max_{0 \leqslant s \leqslant t} X(s) \geqslant \lambda\Big) \leqslant \frac{1}{\lambda} E(X(t)^{+})
$$
此时利用上面得到的结果，就有
$$
\begin{align}
P\left(A_{k}\right) &\leqslant 2^{k} E\left[\max\limits_{t \in [0, T]}~\left\|  \boldsymbol{X}^{(k+1)}(t) - \boldsymbol{X}^{(k)}(t) \right\|^{2}\right] \leqslant C \cdot \frac{2^{k}M^{k}T^{k}}{k!}
\end{align}
$$
此时我们可以估计这个上界的阶，当 $k \rightarrow \infty$ 时，由 Stirling 公式，有
$$
C \cdot \frac{2^{k}M^{k}T^{k}}{k!} \sim C' \cdot \frac{(2eMT)^{k}}{\sqrt{ k } \cdot k!}
$$
于是下面的级数收敛：
$$
\sum\limits_{k=0}^{\infty} P(A_{k}) \leqslant C \sum\limits_{k=0}^{\infty}  \frac{2^{k}M^{k}T^{k}}{k!} < \infty.
$$
使用 Borel-Cantelli 引理的条件达成了，我们立刻得到 $P(A_{k} \text{ i.o.}) = 0$，即 $\boldsymbol{X}^{(k)}$ 在 $[0, T]$ 上几乎必然一致收敛，且收敛到原 SDE 的解。

最后我们证明 $\boldsymbol{X}^{(k)}$ 收敛到的极限在 $\mathbb{L}^{2}([0, T])$ 中，即证明 $E[\|\boldsymbol{X}\|^{2}]$ 有限。首先估计 $E[\|\boldsymbol{X}^{(k+1)}\|^{2}]$：
$$
\begin{align}
E[\|\boldsymbol{X}^{(k+1)}\|^{2}] &= E\left[ \left\| \boldsymbol{X}_{0} + \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) \, \mathrm{d}W   \right\|^{2} \right]\\
&\leqslant CE[\|\boldsymbol{X}_{0}\|^{2}] + CE \left[ \left\| \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}^{(k)}, s) \, \mathrm{d}s \right\|^{2} \right] + CE\left[ \left\|  \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) \, \mathrm{d}W  \right\|^{2} \right] \\
&\leqslant CE[\|\boldsymbol{X}_{0}\|^{2}] + CTE \left[  \int_{0}^{t} \left\|\boldsymbol{b}(\boldsymbol{X}^{(k)}, s)\right\|^{2} \, \mathrm{d}s  \right] + CE\left[  \int_{0}^{t}\left\|  \boldsymbol{B}(\boldsymbol{X}^{(k)}, s) \right\|^{2} \, \mathrm{d}s  \right] \\
&\leqslant C'E[\|\boldsymbol{X}_{0}\|^{2}] + C'E \left[  \int_{0}^{t} L\left(1 + \left\|\boldsymbol{X}^{(k)}\right\|\right)^{2} \, \mathrm{d}s  \right] + C'E\left[  \int_{0}^{t} L\left(1 + \left\|\boldsymbol{X}^{(k)}\right\|\right)^{2} \, \mathrm{d}s  \right] \\
&\leqslant C''(1 + E[\|\boldsymbol{X}_{0}\|^{2}]) +  C''\int_{0}^{t} E(\|\boldsymbol{X}^{(k)}\|^{2}) \, \mathrm{d} s \quad \quad \quad  选择合适 C''\\
&\leqslant C''(1 + E[\|\boldsymbol{X}_{0}\|^{2}]) +  C''\int_{0}^{t} \left[ C''(1 + E[\|\boldsymbol{X}_{0}\|^{2}]) +  C''\int_{0}^{s'} E(\|\boldsymbol{X}^{(k-1)}\|^{2}) \, \mathrm{d} s \right]  \, \mathrm{d} s'\\
&= (1 + E[\|\boldsymbol{X}_{0}\|^{2}])(C'' + tC''^{2}) + C''^{2}\int_{0}^{t} \int_{0}^{s'} E[\|\boldsymbol{X}^{(k-1)}(s)\|]  \, \mathrm{d}s \, \mathrm{d} s'\\
&= (1 + E[\|\boldsymbol{X}_{0}\|^{2}])(C'' + tC''^{2}) + 
C''^{3}\int_{0}^{t} \int_{0}^{s'} \left[ (1 + E[\|\boldsymbol{X}_{0}\|^{2}]) +  \int_{0}^{s''} E(\|\boldsymbol{X}^{(k-2)}\|^{2}) \, \mathrm{d} s''' \right]   \, \mathrm{d}s'' \, \mathrm{d} s'\\
&= (1 + E[\|\boldsymbol{X}_{0}\|^{2}])\left( C'' + tC''^{2} + \frac{t^{2}}{2}C''^{3} \right) + C''^{3} \int_{0}^{t} \int_{0}^{s_{1}} \int_{0}^{s_{2}} E(\|\boldsymbol{X}^{(k-2)}\|) \, \mathrm{d} s_{3} \, \mathrm{d} s_{2} \, \mathrm{d} s_{1}\\
&\leqslant \cdots 
\end{align}
$$
读者也许会发现规律，这样一直写下去，会得到
$$
E[\|\boldsymbol{X}^{(k+1)}\|^{2}] \leqslant (1 + E[\|\boldsymbol{X}_{0}\|^{2}])\left( C + C^{2}t + C^{3}\frac{t^{2}}{2} + \cdots + C^{k+1} \frac{t^{k}}{k!}\right) + C^{k+1}\int_{0}^{t} \int_{0}^{s_{1}} \cdots \int_{0}^{s_{k}} E[\|\boldsymbol{X}_{0}\|^{2}] \, \mathrm{d}s_{k+1} \cdots \, \mathrm{d} s_{2} \, \mathrm{d}s_{1} 
$$
注意积分中是常函数，所以右侧的积分区域是类似顺序统计量的单纯形区域，其体积为 $\displaystyle \frac{t^{k+1}}{(k+1)!}$，因此可以得到
$$
\begin{align}
E[\|\boldsymbol{X}^{(k+1)}\|^{2}] &\leqslant (1 + E[\|\boldsymbol{X}_{0}\|^{2}])\left( C + C^{2}t + C^{3}\frac{t^{2}}{2} + \cdots + C^{k+1} \frac{t^{k}}{k!}\right) +  \frac{C^{k+1}t^{k+1}}{(k+1)!}E[\|\boldsymbol{X}_{0}\|^{2}]\\
&\leqslant (1 + E[\|\boldsymbol{X}_{0}\|^{2}])\left( C + C^{2}t + C^{3}\frac{t^{2}}{2} + \cdots + C^{k+2} \frac{t^{k+1}}{(k+1)!}\right) \\
&\leqslant (1 + E[\|\boldsymbol{X}_{0}\|^{2}])Ce^{Ct}.
\end{align}
$$
这样就证明了 $E[\|\boldsymbol{X}^{(k+1)}\|^{2}]$ 是有界的，且该界与 $k$ 无关。上面的不等式两侧对 $k$ 去极限，得到
$$
\mathbb{E}[\|\boldsymbol{X}\|^{2}] \leqslant (1 + E[\|\boldsymbol{X}_{0}\|^{2}])Ce^{Ct} \implies \boldsymbol{X} \in \mathbb{L}_{n}^{2}([0, T]).
$$
这个定理的证明到此结束。

为了证明该定理条件下 SDE 解的存在性和唯一性，我们首先使用证明了唯一性，然后通过迭代构造了一个 $\mathbb{L}_{n}^{2}([0, T])$ 中的序列，我们先证明了相邻两项的平方距离是有界的，然后利用这个上界证明这个序列在 $[0, T]$ 上几乎必然一致收敛，最后证明收敛到的极限是 $\mathbb{L}_{n}^{2}([0, T])$ 中的元素。

## 5.3 解的性质

本节我们不加证明地引入一些 SDE 解的部分性质。

> **定理 5.14（高阶矩的估计）**
> 考虑满足解的存在唯一性定理条件的 $\boldsymbol{b}$ 和 $\boldsymbol{B}$，如果对某个 $p > 1$，还成立下面的条件：
> $$E(|\boldsymbol{X}_{0}|^{2p}) < \infty,$$
> 则 SDE $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t) \mathrm{d} t + \boldsymbol{B}(\boldsymbol{X}, t) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right.$ 满足下面的估计不等式：
> $$\begin{align}E(|\boldsymbol{X}(t)|^{2p} &\leqslant C_{2}(1 + E(|X_{0}|^{2p}))e^{C_{1}t}\\E(|\boldsymbol{X}(t) - \boldsymbol{X}_{0}|^{2p} &\leqslant C_{2}(1 + E(|X_{0}|^{2p}))t^{p}e^{C_{1}t}t^{p}\\\end{align}$$
> 其中常数 $C_{1}, C_{2}$ 只和 $T, L, m, n, p$ 有关。

尽管对矩的估计比较粗糙，它依然是有用的：

> **示例 5.15（采样路径的性质）**
> 上述讨论中并不排除 $\boldsymbol{B} \equiv 0$ 的可能性。若 $\boldsymbol{B} \equiv 0$，则原 SDE 的解为 ODE $\dot{\boldsymbol{X}} = \boldsymbol{b}(\boldsymbol{X}, t)$，在可能随机的初值条件下的解。如果 $\boldsymbol{b}$ 是光滑的，那么解 $t \mapsto \boldsymbol{X}(t)$ 也将是光滑的；反之如果存在 $1 \leqslant i \leqslant n$，使得对所有 $x \in \mathbb{R}^{n}, 0 \leqslant t \leqslant T$ 有
> $$\sum\limits_{i \leqslant l \leqslant m} |b^{il}(x, t)|^{2} > 0$$
> 则几乎所有 $\omega$ 对应的采样轨道都是无处可微的。


> **定理 5.16（参数依赖性）**
> 假设对 $k = 1, 2, \dots$，$\boldsymbol{b}^{(k)}, \boldsymbol{B}^{(k)}$ 和 $\boldsymbol{X}_{0}^{(k)}$ 都满足存在唯一性定理的条件，且对应同一个 $L$，如果它们还满足
> $$\lim_{ k \to \infty } E(|\boldsymbol{X}_{0}^{(k)} - \boldsymbol{X}_{0}|^{2}) = 0$$
> 以及对任意 $M>0$，成立
> $$\lim_{ k \to \infty } \max\limits_{{\scriptstyle 0 \leqslant t \leqslant T}\atop{\scriptstyle |x| \leqslant M} }~\Big( |\boldsymbol{b}^{(k)}(x, t) - \boldsymbol{b}(x, t)| + |\boldsymbol{B}^{(k)}(x, t) - \boldsymbol{B}^{(k)}(x, t)| \Big) = 0$$
> 最后假设 $\boldsymbol{X}^{(k)}$ 是 $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X}^{(k)} &= \boldsymbol{b}^{(k)}(\boldsymbol{X}^{(k)}, t) \mathrm{d} t + \boldsymbol{B}^{(k)}(\boldsymbol{X}^{(k)}, t) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}^{(k)}(0) &= \boldsymbol{X}_{0}^{(k)}\end{align} \right.$ 的解，则有 $\displaystyle \lim_{ k \to \infty }E\Big( \max\limits_{0 \leqslant t \leqslant T}~|\boldsymbol{X}^{(k)}(t) - \boldsymbol{X}(t)|^{2} \Big) = 0$，其中 $\boldsymbol{X}$ 是 $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t) \mathrm{d} t + \boldsymbol{B}(\boldsymbol{X}, t) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right.$ 的解。

> **示例 5.17（微小噪声的情形）**
> 特别地，对几乎所有 $\omega$，$\varepsilon \rightarrow 0$ 时SDE $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X}^{(\varepsilon)} &= \boldsymbol{b}(\boldsymbol{X}^{(\varepsilon)}) \mathrm{d} t + \varepsilon \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}^{(\varepsilon)}(0) &= x_{0}\end{align} \right.$ 的解在 $[0, T]$ 上一致收敛到 $\displaystyle \left\{ \begin{align} \dot{\boldsymbol{x}} &= \boldsymbol{b}(\boldsymbol{x})\\ \boldsymbol{x}(0) &= x_{0}\end{align} \right.$ 的解轨道，不过在长的时间尺度上，小噪音项对系统动力学的影响深远。

## 5.4 线性随机微分方程
### 5.4.1 记号

> **定义 5.18（线性随机微分方程）**
> 随机微分方程 $\mathrm{d}\boldsymbol{X} = \boldsymbol{b}(\boldsymbol{X}, t)\mathrm{d}t+\boldsymbol{B}(\boldsymbol{X}, t)\mathrm{d}\boldsymbol{W}$ 线性，是指 $\boldsymbol{b}$ 和 $\boldsymbol{B}$ 都有下面的形式：
> $$\begin{align}\boldsymbol{b}(\boldsymbol{x}, t) = \boldsymbol{c}(t) + \boldsymbol{D}(t)\boldsymbol{x}\\\boldsymbol{B}(\boldsymbol{x}, t) = \boldsymbol{E}(t) + \boldsymbol{F}(t)\boldsymbol{x}\\\end{align}$$
> 其中 $\boldsymbol{c}: [0, T] \in \mathbb{R}^{n}, \boldsymbol{D}: [0, T] \rightarrow \mathbb{M}^{n \times n}, \boldsymbol{E}: [0, T] \rightarrow \mathbb{M}^{n \times m}, \boldsymbol{F}: \rightarrow L(\mathbb{R}^{n}, \mathbb{M}^{n \times m})$，其中 $L(\mathbb{R}^{n}, \mathbb{M}^{n \times m})$ 指的是 $\mathbb{R}^{n}$ 到 $\mathbb{M}^{n \times m}$ 的线性变换的集合。

> **定义 5.19（线性其次和狭义线性）**
> 对于 定义 5.18 中的线性 SDE，如果在 $t \in [0, T]$ 上有 $\boldsymbol{c} \equiv \boldsymbol{E} \equiv 0$，称它是**齐次**的；如果在相同条件下有 $\boldsymbol{F} \equiv 0$，则称其为**狭义线性**的。

> **注解 5.20**
> 如果 $\boldsymbol{c}, \boldsymbol{d}, \boldsymbol{E}, \boldsymbol{F}$ 满足
> $$\sup_{o \leqslant t \leqslant T} \Big[ |\boldsymbol{c}(t)| + |\boldsymbol{D}(t)| + |\boldsymbol{E}(t)| + |\boldsymbol{F}(t)| \Big] < \infty $$
> 则它们构成得到的 $\boldsymbol{b}, \boldsymbol{B}$ ，满足存在唯一性定理的条件；如果$E(|\boldsymbol{X}_{0}|^{2}) < \infty$，且 $\boldsymbol{X}_{0}$ 和 $\mathcal{W}^{+}(0)$ 独立，对应的 SDE 有唯一解。

### 5.4.2 狭义线性 SDE 的求解公式

> **定理 5.21（线性随机微分方程的求解公式）**
> 线性随机微分方程 $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= (\boldsymbol{c}(t) + D\boldsymbol{X})\mathrm{d} t + (\boldsymbol{E}(t) + \boldsymbol{F}(t)\boldsymbol{X}) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right.$ 的解为
> $$\boldsymbol{X}(t) = e^{Dt}\boldsymbol{X}_{0} + \int_{0}^{t} e^{D(t-s)}(\boldsymbol{c}(t)\,\mathrm{d}s + \boldsymbol{E}(s) \,\mathrm{d} \boldsymbol{W})$$
> 一般地，方程 $\displaystyle \left\{ \begin{align}\mathrm{d}\boldsymbol{X} &= (\boldsymbol{c}(t) + \boldsymbol{D}(t)\boldsymbol{X})\mathrm{d} t + (\boldsymbol{E}(t) + \boldsymbol{F}(t)\boldsymbol{X}) \mathrm{d} \boldsymbol{W}\\ \boldsymbol{X}(0) &= \boldsymbol{X}_{0}\end{align} \right.$ 的解为
> $$\boldsymbol{X}(t) = \Phi(t)\left[ \boldsymbol{X}_{0} + \int_{0}^{t}  \Phi(s)^{-1}(\boldsymbol{c}(t)\,\mathrm{d}s + \boldsymbol{E}(s) \,\mathrm{d} \boldsymbol{W}) \right] \tag{*}$$
> 其中 $\Phi(t)$ 是非自治（时变）ODE $\displaystyle \left\{ \begin{align} \dot{\Phi} &= \boldsymbol{D}(t)\Phi\\ \Phi(0) &= \boldsymbol{I}\end{align} \right.$ 的**基本矩阵**。

可以将上面的基本矩阵理解为同时以所有不同状态（$\boldsymbol{e}_{i}$）出发，经历 $\dot{\boldsymbol{x}} = \boldsymbol{D}(t)\boldsymbol{x}$ 演化的结果组成的矩阵。如果将 $\boldsymbol{E}\mathrm{d}\boldsymbol{W}$ 写成 $\boldsymbol{E}\xi \mathrm{d}t$，其中 $\xi$ 是白噪声，并将其看作是非齐次项，得到的 ODE
$$
\dot{\boldsymbol{X}} = \boldsymbol{c}(t) + \boldsymbol{D}(t)\boldsymbol{X} + \boldsymbol{E}(t) \xi
$$
然后利用 ODE 的求解公式能得到和上面相同的结果。但当 $\boldsymbol{F} \equiv 0$ 时情况就不一样了，Ito 链式法则会多出一项。

最后如果 $\boldsymbol{X}_{0}$ 服从 Gauss 分布，则 $X(t)$ 也将是 Gauss 分布，因为 (\*) 是作用在 $\boldsymbol{X}_{0}$ 上和 $\boldsymbol{E}(s)\mathrm{d}\boldsymbol{W}$ 的线性泛函，且 $\boldsymbol{E}(s)\mathrm{d}\boldsymbol{W}$ 积分得到的也是 Gauss 随机变量。

### 5.4.3 广义线性标量 SDE 的求解公式

> **定理 5.22（一维的一般情形）**
> 假设 $n = 1$，$m \geqslant 1$，下面的 SDE
> $$\displaystyle \left\{ \begin{align}\mathrm{d}X &= (c(t) + d(t)X)\mathrm{d} t + \sum\limits_{l=1}^{M} (e^{(l)}(t) + f^{(l)}(t)X) \mathrm{d} W^{(l)}\\ X(0) &= X_{0}\end{align} \right.$$
> 的解为
> $$X(t) = \Phi(t)\left[ X_{0} + \int_{0}^{t} \Phi(s)^{-1}\left( c(s) - \sum\limits_{l=1}^{M} e^{(l)}(s)f^{(l)}(s) \right) \, \mathrm{d}s  \right] + \int_{0}^{t} \sum\limits_{l=1}^{M} \Phi(s)^{-1}e^{(l)}(s) \, \mathrm{d}W^{(l)}, $$
> 其中
> $$\Phi(t) = \exp\left[ \int_{0}^{t} d - \sum\limits_{l=1}^{M} \frac{(f^{(l)})^{2}}{2} \, \mathrm{d}s + \int_{0}^{t} \sum\limits_{l=1}^{M} f^{(l)} \, \mathrm{d}W^{(l)} \right].$$

### 5.4.4 求解线性 SDE 的方法

本节我们看几个 SDE 的例子，以复习 Ito 链式法则。

> **示例 5.23**
> $$\displaystyle \left\{ \begin{align}\mathrm{d}X &= d(t) X \mathrm{d} t + f(t) X \mathrm{d} W\\ X(0) &= X_{0}\end{align} \right.$$

这个方程是 $m = n = 1$ 的情形。我们尝试找到两个过程 $X_{1}$ 和 $X_{2}$ ，使得 $X =X_{1}X_{2}$，其中
$$
\begin{cases}
\mathrm{d}X_{1} = f(t)X_{1}\mathrm{d}W\\X_{1}(0) = X_{0}
\end{cases}, \quad 
\begin{cases}
\mathrm{d}X_{2} = A(t)\mathrm{d}t + B(t)\mathrm{d}W\\X_{2}(0) = 1
\end{cases}
$$
其中 $A$ 和 $B$ 是未知的过程（或确定函数），需要求解得出。这么设定的原因是通过 Ito 乘积法则，有
$$
\begin{align}
\mathrm{d}X &= \mathrm{d}(X_{1}X_{2})\\
&= X_{2}\mathrm{d}X_{1} + X_{1}\mathrm{d}X_{2} + G_{1}G_{2}\mathrm{d}t\\
&= f(t)X_{1}X_{2}\mathrm{d}W + \big[A(t)\mathrm{d}t + B(t)\mathrm{d}W\big]X_{1} + f(t)B(t)X_{1}\mathrm{d}t\\
&= {\color{red} f(t)X\mathrm{d}W } + {\color{blue} \big[A(t)\mathrm{d}t + B(t)\mathrm{d}W\big]X_{1} + f(t)B(t)X_{1}\mathrm{d}t } 
\end{align}
$$
可见这样设置之下通过乘积法则就自然产生了原 SDE 的第一项（红色），剩下就需要找适当的 $A$ 和 $B$，使得
$$
\big[A(t)\mathrm{d}t + B(t)\mathrm{d}W\big]X_{1} + f(t)B(t)X_{1}\mathrm{d}t = d(t)X\mathrm{d}t
$$
不难发现当 $B \equiv 0, A(t) = d(t)X$ 时上面的等式成立。因此 $X_{2}$ 满足 $\displaystyle \begin{cases}\mathrm{d}X_{2} = d(t)X\mathrm{d}t \\ X_{2}(0) = 1\end{cases}$，这是一个 ODE，其解为 
$$X_{2}(t) = \exp\left\{\int_{0}^{t} d(s) \, \mathrm{d}s \right\},$$
对于 $X_{1}$，我们在实例 5.5 中已给出其解为
$$
X_{1}(t) = X_{0}\exp\left\{ \int_{0}^{t} f(s) \, \mathrm{d}W - \frac{1}{2}\int_{0}^{t} f^{2}(s) \, \mathrm{d}s   \right\},
$$
因此最终的解为上述两项相乘：
$$
X(t) = X_{0}\exp\left\{ \int_{0}^{t} f(s) \, \mathrm{d}W + \int_{0}^{t} d(s) - \frac{1}{2}f^{2}(s) \, \mathrm{d}s   \right\},
$$

接下来考虑一个更加一般的情况。

> **示例 5.24**
> $$\displaystyle \left\{ \begin{align}\mathrm{d}X &= (c(t) + d(t) X) \mathrm{d} t + (e(t) + f(t) X) \mathrm{d} W\\ X(0) &= X_{0}\end{align} \right.$$

我们使用类似的思路，假设 $X = X_{1}X_{2}$，但本例中两者的预设稍有不同：
$$
\begin{cases}
\mathrm{d}X_{1} = d(t)X_{1}\mathrm{d}t + f(t)X_{1}\mathrm{d}W\\X_{1}(0) = 1
\end{cases}, \quad 
\begin{cases}
\mathrm{d}X_{2} = A(t)\mathrm{d}t + B(t)\mathrm{d}W\\X_{2}(0) = X_{0}
\end{cases}
$$
根据 Ito 乘积法则，有
$$
\begin{align}
\mathrm{d}X &= X_{1}\mathrm{d}X_{2} + X_{2}\mathrm{d}X_{1} + G_{1}G_{2}\mathrm{d}t\\
&= \big[ A(t)\mathrm{d}t +B(t)\mathrm{d}W \big] X_{1} + {\color{red}d(t)X_{1}X_{2}\mathrm{d}t + f(t)X_{1}X_{2}\mathrm{d}W}  + f(t)B(t)X_{1}\mathrm{d}t\\
&= {\color{red} d(t)X\mathrm{d}t + f(t)X\mathrm{d}W } + {\color{blue} \big[ A(t)\mathrm{d}t +B(t)\mathrm{d}W \big] X_{1} + f(t)B(t)X_{1}\mathrm{d}t } 
\end{align}
$$
上述推导可见原 SDE 的两项已经出现（红色部分），$A$ 和 $B$ 只需满足
$$
\big[ A(t)\mathrm{d}t +B(t)\mathrm{d}W \big] X_{1} + f(t)B(t)X_{1}\mathrm{d}t = c(t)\mathrm{d}t + e(t)\mathrm{d}W
$$
即可。可见 $B(t) = e(t)[X_{1}(t)]^{-1}$，$A(t) = \big[ c(t) - f(t)e(t) \big] \cdot [X_{1}(t)]^{-1}$。注意 $X_{1}$ 满足的 SDE 为上个例题所讨论的，可得 $\displaystyle X_{1}(t) = \exp\left\{ \int_{0}^{t} f(s) \, \mathrm{d}W + \int_{0}^{t} d(s) - \frac{1}{2}f^{2}(s) \, \mathrm{d}s   \right\},$ 而 $X_{2}$ 可以直接积分得到：
$$
X_{2}(t) = X_{0} + \int_{0}^{t} \big[ c(s) - f(s)e(s) \big] \cdot [X_{1}(s)]^{-1} \, \mathrm{d} s + \int_{0}^{t} e(s)[X_{1}(s)]^{-1} \, \mathrm{d}s. 
$$
将 $X_{1}$ 代入即可。

> **注解 5.25**
> 随机方程的数值解在理论和应用领域都有着广泛的热度。入门该领域可阅读 D. J. Higham 所著的 An algorithmic introduction to numerical simulation of stochastic differ- ential equations，并同时参考 P. E. Kloeden 和 E. Platen 所著的 Numerical Solution of Stochastic Differential Equations。



