# 第四章 随机积分
## 4.1 预备知识

在第一章里面我们看到了随机微分方程的形态
$$
\begin{align}
\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t)\mathrm{d}t + \boldsymbol{B}(\boldsymbol{X}, t)\mathrm{d}\boldsymbol{W}\\
\boldsymbol{X}(0) &= \boldsymbol{X}_{0}
\end{align}
$$
其中  $\boldsymbol{B}: \mathbb{R}^{n} \rightarrow \mathbb{M}^{n \times m}$。在这章中它将被转化为
$$
\boldsymbol{X}(t) = \boldsymbol{X}_{0} + \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) \, \mathrm{d}\boldsymbol{W} , \quad t \geqslant 0.
$$
但在此之前，我们首先要弄清楚对于满足 "恰当" 性质的随机过程 $\boldsymbol{G}$， $\displaystyle \int_{0}^{T} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W}$ 到底是什么意思，我们应该怎么定义它。

然而这件事似乎并不显然：Brown 运动的采样路径 $t \mapsto \boldsymbol{W}(t, \omega)$ 对几乎所有 $\omega$ 都有无限变差，这个积分项显然不能按照通常的积分理解。

### 4.1.1 Paley-Wiener-Zygmund 随机积分

当 $m=n=1$ 时，我们首先介绍 Paley，Wiener 和 Zygmund 提出的定义

> **定义 4.1 （Paley-Wiener-Zygmund, 随机积分）**
> 考虑连续可微的函数 $g: [0, T] \rightarrow \mathbb{R}$，有 $g(0) = g(T) = 0$，定义 
> $$\int_{0}^{T} g \, \mathrm{d}W \coloneqq -\int_{0}^{T} g'W \, \mathrm{d}t  $$

注意 $\displaystyle \int_{0}^{T} g \, \mathrm{d}W$ 是随机变量。接下来看一些随机积分的性质

> **引理 4.2**
> 1. $\displaystyle E\left( \int_{0}^{T} g \, \mathrm{d}W \right) = 0$
> 2. $\displaystyle E\left[ \left( \int_{0}^{T} g \, \mathrm{d}W \right)^{2} \right] = \int_{0}^{T} g^{2} \, \mathrm{d}t$

**证明.**
（1）$\displaystyle E\left( \int_{0}^{T} g \, \mathrm{d}W \right) = -E\left( \int_{0}^{T} g'W \, \mathrm{d}t \right) = -\int_{0}^{T} g'E(W) \, \mathrm{d}t = 0$
（2）
$$
\begin{align}
E\left[ \left( \int_{0}^{T} g \, \mathrm{d}W \right)^{2} \right] &= E\left[ \left( \int_{0}^{T} g'W \, \mathrm{d}s \right) \left( \int_{0}^{T} g'W \, \mathrm{d}t \right) \right]\\
&= E\left[ \int_{0}^{T} \int_{0}^{T}  g'(s)g'(t)\underbrace{ W(s)W(t) }_{ s \wedge t } \, \, \mathrm{d}s\mathrm{d}t  \right]\\
&= E\left[ \int_{0}^{T} g'(t)\left( {\color{red}\int_{0}^{t}  sg'(s) \, \, \mathrm{d}s} + {\color{blue} t\int_{t}^{T}  g'(s) \, \, \mathrm{d}s }  \right)\mathrm{d}t  \right]\\
&= E\left[ \int_{0}^{T} g'(t)\left( {\color{red} tg(t)-\int_{0}^{t} g(s) \, \mathrm{d}s }   + {\color{blue} t(\underbrace{ g(T) }_{ 0 } - g(t))  } \right)\mathrm{d}t  \right] & \begin{array}{l}{\color{red} 分部积分} \\
\color{blue}\text{Newton-Leibniz 公式}\end{array}\\
&= -E \left[ \int_{0}^{T} g'(t)U  \left( \int_{0}^{t} g(s) \, \mathrm{d}s  \right)  \, \mathrm{d}t  \right] \\
&= -E\left[ \underbrace{ \left. g(t)\int_{0}^{t} g(s) \, \mathrm{d}s  \right|^{T}_{0} }_{ 0 } - \int_{0}^{T} [g(t)]^{2} \, \mathrm{d}t  \right] = \int_{0}^{T} g^{2} \, \mathrm{d}t. & 分部积分
\end{align}
$$

事实上我们可以对定义 4.1 做推广：考虑 $g \in L^{2}(0, T)$，以及一个函数序列 $\{ g_{n} \}$，其中 $g_{i} \in \mathscr{C}^{1}$，同时满足 $g_{i}(0) = g_{i}(T) = 0$，使得 $\displaystyle \int_{0}^{T} (g_{n}-g)^{2}\, \mathrm{d}t = 0$，根据性质 2 和积分的线性性，有
$$
\begin{align}
E\left[ \left( \int_{0}^{T} g_{m} \, \mathrm{d}W - \int_{0}^{T} g_{n} \, \mathrm{d}W  \right)^{2} \right] &= E\left[ \left( \int_{0}^{T} (g_{m}  -  g_{n}) \, \mathrm{d}W  \right)^{2} \right] = \int_{0}^{T} (g_{m}-g_{n})^{2} \, \mathrm{d}t 
\end{align}
$$
因此 $\displaystyle \left\{  \int_{0}^{T} g_{n} \, \mathrm{d}W  \right\}_{n=1}^{\infty}$ 在 $L^{2}(\Omega)$ 中是一个 Cauchy 列。因此我们可以定义 
$$
\int_{0}^{T} g \, \mathrm{d}W  \coloneqq \lim_{ n \to \infty } \int_{0}^{T} g_{n} \, \mathrm{d}W 
$$
这样对原定义的拓展依然满足引理中的两条性质。

> **注释 4.3**
> 由于在 Paley-Wiener-Zygmund 的定义中要求 $g$ 是一个确定的函数。我们还是没有办法处理 $\displaystyle \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) \, \mathrm{d}\boldsymbol{W}$ 这样的东西，因此我们必须将其拓展到更大范围的被积对象上，并在确定函数情况下和 Paley-Wiener-Zygmund 的定义保持一致。

### 4.1.2 Riemann 和

在开始进一步讨论之前，我们来看看对于一个一维 Brown 运动 
$$\int_{0}^{T} {W} \, \mathrm d{W}$$
应该如何定义。一个比较自然的方法是用 Riemann 和然后取极限（如果极限存在）。

> **定义 4.4 （划分）**
> 给定区间 $[0, T]$，它的一个划分（partition） $P$ 是该区间中的有限个不同的点构成的集合 $P:=\{ 0 = t_{0} < t_{1} <\cdots < t_{m} = T \}$。该划分的 *网格大小* 定义为 $\displaystyle |P| := \max_{0 \leqslant k \leqslant m-1} |t_{k+1}-t_{k}|$。对于固定的 $0 \leqslant \lambda \leqslant 1$，和 $[0, T]$ 上的给定划分 $P$，定义 $\tau_{k} := (1-\lambda)t_{k} + \lambda t_{k+1}$，它是 $[t_{k}, t_{k+1}]$ 区间上的一点。

> **定义 4.5 （ $\displaystyle \int_{0}^{T} {W} \, \mathrm d{W}$ 的 Riemann 和估计）**
> 对于 $[0, 1]$ 上的给定划分 $P$，记
> $$R = R(P, \lambda) := \sum\limits_{k=0}^{m-1} W(\tau_{k})\big[ W(t_{k+1})-W(t_{k}) \big] $$
> 为随机积分 $\displaystyle \int_{0}^{T} {W} \, \mathrm d{W}$ 的 Riemann 和估计。

我们的核心问题是，固定 $\lambda$ 的值上述估计在 $|P| \rightarrow 0$ 时会发生什么？

> **引理 4.6 （Brown 运动轨道的二次变差）**
> 考虑 $[0, \infty)$ 上的一个区间 $[a, b]$，定义该区间上的一个划分序列
> $$P^{(n)} := \{ a = t_{0}^{(n)} < t_{1}^{(n)} < \cdots < t_{m_{n}}^{(n)} = b \}$$
> 它满足当 $n \rightarrow \infty$ 时，$|P^{(n)}| \rightarrow 0$。于是有在 $L^{2}(\Omega)$ 中当 $n \rightarrow \infty$ 时，有
> $$Q_n = \sum\limits_{k=0}^{m_{n}-1} \big[ W(t_{k+1}^{(n)}) - W(t_{k}^{(n)}) \big]^{2} \rightarrow b-a$$

**证明.**
首先注意到
$$
Q_{n} - (b - a) = \sum\limits_{k=0}^{m_{n}-1}  \Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) \Big).
$$
因此
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} \sum\limits_{j=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) \Big)\\&\hspace{7em}\times \Big(\big[ W\big(t_{j+1}^{(n)}\big) - W\big(t_{j}^{(n)}\big) \big]^{2} - \big(t_{j+1}^{(n)} - t_{j}^{(n)}\big) \Big) \Big]  
\end{align}
$$
当两个求和指标 $k$ 和 $j$ 不同时，根据 Brown 运动的增量独立性，有 $W(t_{k+1}^{(n)}) - W(t_{k}^{(n)})) \sim N(0, t_{k+1}^{(n)} - t_{k}^{(n)})$。因此
$$
\begin{align}
&\,E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\Big]\\
=&\, E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2}\Big] - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\\
=&\,\underbrace{ (t_{k+1}^{(n)} - t_{k}^{(n)}) }_{ \sigma^{2}=t_{k+1}^{(n)} - t_{k}^{(n)} } + \underbrace{ 0 }_{ \mu^{2}=0 } - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) = 0.
\end{align}
$$
因此双重求和中的非 “对角” 项都为零，就得到当 $n \rightarrow \infty$ 时，
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)  \Big)^{2}\Big]  \\
&= \sum\limits_{k=0}^{m_{n}-1}  
{\color{red} \underbrace{E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{4} }_{ 四阶原点矩 = \mu^{4} + 6\mu^{2} \sigma^{2} + 3\sigma^{4}}\Big] }  - 2{\color{blue} \underbrace{E\Big[ \big[W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} \Big]}_{ 二阶原点矩=\mu^{2}+\sigma^{2}=t_{k+1}^{(n)} - t_{k}^{(n)} } } \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\\&\hspace{5em} + \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}\\
&= \sum\limits_{k=0}^{m_{n}-1}  
{\color{red} 3 \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} }  - {\color{blue} 2 \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} }  + \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}\\
&= 2\sum\limits_{k=0}^{m_{n}-1} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} \leqslant 2|P^{n}|\sum\limits_{k=0}^{m_{n}-1} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) = 2|P^{n}|(b-a) \rightarrow 0.
\end{align}
$$
除此之外因为我们发现 $W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big)$ 的方差恰好就是 $t_{k+1}^{(n)} - t_{k}^{(n)}$，因此还可以这样做
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)  \Big)^{2}\Big]  \\
 &= \sum\limits_{k=0}^{m_{n}-1} E\left[ 
\left(\left[ \frac{W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big)}{\color{red} \sqrt{ t_{k+1}^{(n)} - t_{k}^{(n)} }}  \right]^{2} - 1 \right)^{2}{\color{red} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} } \right]  \\
&= \sum\limits_{k=0}^{m_{n}-1} E[\left( Y_{n} - 1 \right)^{2}] \cdot \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} \leqslant C\sum\limits_{k=0}^{m_{n}-1}\big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}. 
\end{align}
$$
> **注释 4.7 （$\mathrm{d}W \approx \mathrm{d}t^{1/2}$）**
> 可以看出，对于微小的时间增量 $\mathrm{d}t$，Brown 运动（轨道）的增量 $\mathrm{d}W$ 服从 Gauss 分布 $N(0, \mathrm{d}t)$，其标准差恰好是 $\mathrm{d}t^{1/2}$，这说明在时间间隔 $\mathrm{d}t$ 内，轨道增量 $\mathrm{d}W$ 的变化水平大致是 $\mathrm{d}t^{1/2}$，这一定程度上解释了第一章中提到的 $\mathrm{d}W \approx \mathrm{d}t^{1/2}$ 这件事情。

> **注释 4.8 （Brown 运动轨道在区间上变差几乎必然无限）**
> 另一方面，因为当 $n \rightarrow \infty$ 时，$Q_{n}$ 在 $L^{2}(\Omega)$ 中有极限 $b-a$。由于 Brown 运动本身对一切 $0 < \gamma < \displaystyle \frac{1}{2}$，我们在样本空间中找一个样本点使得该结论成立，这个样本点对应的 Brown 运动轨道有一致 $\gamma$-Hölder 连续性，因此存在 $K$，使得
> $$\begin{align} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big| &\leqslant K \big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma}\\ \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\ \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \sum\limits_{k=0}^{m_{n}-1}\big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\ &\leqslant K \big|P^{(n)}\big|^{\gamma}\sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\b-a=\limsup_{ n \to \infty } \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \limsup_{ n \to \infty } |P^{(n)}|^{\gamma} \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big| \end{align}$$
> 由于 $|P^{(n)}| \rightarrow 0$，等式右边最后一项必须满足 
> $$\sup_{[b-a]\text{ 的划分 }P} \left\{ \sum\limits_{k=0}^{m_{n}-1} |W(t_{k+1})-W(t_{k})| \right\} = \infty.$$
> 这就证明了 Brown 运动轨道在任意闭区间 $[a, b]$ 上的变差几乎一定是无穷大。

有了 Brown 运动轨道平方变差在 $L^{2}(\Omega)$ 中的收敛性后，我们来看看对 $\displaystyle \int_{0}^{T} {W} \, \mathrm d{W}$ 的 Riemann 和估计我们能得到什么。

> **引理 4.9**
> 给定一个固定的 $\lambda \in [0, 1]$，以及区间 $[0, T]$ 上的一列细度趋于零的划分 $P^{(n)}$，定义
> $$R_{n} := \sum\limits_{k=0}^{m_{n}-1} W(\tau_{k}^{(n)})(W(t_{k+1}^{(n)}) - W(t_{k}^{(n)}))$$
> 其中 $\tau_{k}^{(n)} = (1-\lambda)t_{k}^{(n)} + \lambda t_{k+1}^{(n)}$，于是在 $L^{2}(\Omega)$ 中有极限
> $$\lim_{ n \to \infty } R_{n} = \frac{W(T)^{2}}{2} + \left( \lambda - \frac{1}{2} \right) T$$
> 换句话说，*Riemann 和估计的极限值受中点的选取位置影响*。

**证明.**
$$
\begin{align}
R_{n} :=& \sum\limits_{k=0}^{m_{n}-1} W(\tau_{k}^{(n)})({\color{blue} W(t_{k+1}^{(n)}) - W(t_{k}^{(n)}) } )\\
=& \,\frac{1}{2}\sum\limits_{k=0}^{m_{n}-1} \Big[{\color{red} \big(W(\tau_{k}^{(n)}) - W(t_{k}^{(n)})\big) -\big(W(t_{k+1}^{(n)}) - W(\tau_{k}^{(n)})\big) }  + {\color{blue} W(t_{k}^{(n)}) + W(t_{k+1}^{(n)}) } \Big] \\&\hspace{5em} \times \underbrace{ \Big[{\color{red} \big(W(t_{k+1}^{(n)}) - W(\tau_{k}^{(n)})\big) + \big(W(\tau_{k}^{(n)}) - W(t_{k}^{(n)})\big) } \Big] }_{ W(t_{k+1}^{(n)}) - W(t_{k}^{(n)}) }\\
=& \,\frac{1}{2}\sum\limits_{k=0}^{m_{n}-1}\Big[ {\color{red} \big(W(\tau_{k}^{(n)}) - W(t_{k}^{(n)})\big)^{2} -\big(W(t_{k+1}^{(n)}) - W(\tau_{k}^{(n)})\big)^{2} } + {\color{blue} W(t_{k+1}^{(n)})^{2} - W(t_{k}^{(n)})^{2} } \Big] \\
=&\, {\color{blue} \frac{W^{2}(T)}{2} } + \frac{1}{2}\sum\limits_{k=0}^{m_{n}-1} \big(W(\tau_{k}^{(n)}) - W(t_{k}^{(n)})\big)^{2} - \frac{1}{2}\sum\limits_{k=0}^{m_{n}-1} \big(W(t_{k+1}^{(n)}) - W(\tau_{k}^{(n)})\big)^{2}\\
\rightarrow &\, \frac{W^{2}(T)}{2} + \frac{T}{2}\left[ \lambda - (1-\lambda)\right] = \frac{W^{2}(T)}{2} + \left[ \lambda-\frac{1}{2} \right] T. \quad \text{in~}L^{2}(\Omega) &\text{引理 4.6}
\end{align}
$$

> **注释 4.10 （Itô 积分和 Stratonovich 积分）**
> 事实上，Itô 的定义就是取 $\lambda=0$ 得到的：
> $$\int_{0}^{T} {W} \, \mathrm d{W} = \frac{W^{2}(T)}{2} - \frac{T}{2} \tag{Itô}$$
> 另一种定义来自 Stratonovich，取 $\displaystyle \lambda = \frac{1}{2}$：
> $$\int_{0}^{T} {W} \circ\, \mathrm d{W} = \frac{W^{2}(T)}{2} \tag{Stratonovich}$$
> 看起来更自然的定义应该是后面那个，但是前者有一些优势。前者将中点 $\tau^{(n)}$ 选取在划分区间的左端点 $t_{k}^{(n)}$，可以使得 $\displaystyle \int_{0}^{T} {G} \, \mathrm d{W}$ 这样形式的积分可以允许 $G(\cdot)$ 是一大类叫做 **非预期过程** 的随机过程。另一方面，我们不知道随机过程在区间 $[t_{k}^{(n)}, t_{k+1}^{(n+1)}]$ 上的行为，取左端点作为估计最为稳妥。

## 4.2 Itô 积分
### 4.2.1 非预期过程

考虑定义在某个概率空间 $(\Omega, \mathcal{U}, P)$ 上的 Brown 运动 $W(\cdot)$。我们先给出一些定义

> **定义 4.11 （Brown 运动的历史和未来）**
> 在某个概率空间 $(\Omega, \mathcal{U}, P)$ 上的 Brown 运动 $W(\cdot)$，定义下面两个 $\sigma$-代数
> $$\begin{align} \mathcal{W}(t) &:= \mathcal{U}(W(s)|0 \leqslant s \leqslant t)\\\mathcal{W}^{+}(t) &:= \mathcal{U}(W(s)-W(t)| s \geqslant t) \end{align}$$
> 分别为 Brown 运动从开始截止到 $t$ 的 *历史*，以及 Brown 运动在时间 $t$ 之后的 *未来* 。

> **定义 4.12 （非预期的 $\sigma$-代数 / 滤子）**
> 考虑一族 $\sigma$-代数 $\mathcal{F}(\cdot)$，如果它满足
> 1. 对所有 $0 \leqslant s \leqslant t$ 有 $\mathcal{F}(s) \subset \mathcal{F}(t)$
> 2. 对所有 $t \geqslant 0$，有 $\mathcal{W}(t) \leqslant \mathcal{F}(t)$
> 3. 对所有 $t \geqslant 0$，$\mathcal{F}(t)$ 和 $\mathcal{W}^{+}(t)$ 相互独立
> 我们称其相对于 $W(\cdot)$ 是 *非预期的*，或者称其为 *滤子*。

> **注释 4.13**
> 我们可以这样理解 $\mathcal{F}(t)$：它是 $t$ 时刻时我们能掌握到的所有信息。一个很自然的想法就是这样定义
> $$\mathcal{F}(t) := \mathcal{U}\big( W(s)\quad(0 \leqslant s \leqslant t), X_{0} \big) $$
> 其中 $X_{0}$ 是一个和 $\mathcal{W}^{+}(0)$ 无关的随机变量。事实上，$X_{0}$ 就是后面讲到的 SDE 中的 **初值条件**。

> **定义 4.14 （非预期的随机过程）**
> 如果一个实值随机过程 $G(\cdot)$ 满足对任意 $t \geqslant 0$，$G(t)$ 都是 $\mathcal{F}(t)$-可测的，那么就称该随机过程是对 $\mathcal{F}(\cdot)$ 非预期的。

> **注释 4.15**
> 这个定义可以解释为，任何时刻下，$G(t)$ 都只依赖 $\mathcal{F}(t)$ 中的信息

> **注释 4.16**
> 事实上我们其实依赖更强的条件，即 $G(\cdot)$ 需要是 *循序可测 (progressively measurable)* 的，但这个定义比较复杂，因此我们在此只写它是可测的。前者的主要想法是，在 $G(\cdot)$ 是非预期的基础上，它还同时对 $t$ 和 $\omega$ 联合可测。  
> 事实上，如果被积随机过程 $G(\cdot)$ 是循序可测的，那么对应的 Itô 随机积分 $\displaystyle \int_{0}^{T} {G} \, \mathrm d{W}$ 的能写成更加简洁优美又实用的形式。换言之，让 $G(\cdot)$ 只和 Brown 运动的历史相关，而不与其未来相关，世界会更美好。

> **定义 4.17 （循序可测的实值随机过程空间）**
> 定义满足 $\displaystyle E\left( \int_{0}^{T} {G^{2}} \, \mathrm d{t} \right) < \infty$ 的所有循序可测的实值随机过程 $G(\cdot)$ 构成的空间为 $\mathbb{L}^{2}(0, T)$
> 定义满足 $\displaystyle E\left( \int_{0}^{T} |F| \, \mathrm d{t} \right) < \infty$ 的所有循序可测的实值随机过程 $F(\cdot)$ 构成的空间为 $\mathbb{L}^{1}(0, T)$

### 4.2.2 阶梯过程

为了得出一般形式的 Ito 随机积分，我们从性质更好的阶梯过程开始。

> **定义 4.18 （阶梯过程）**
> 对一个随机过程 $G \in \mathbb{L}^{2}(0, T)$ ，如果存在一个 $[0, T]$ 上的划分 $P = \{ 0 = t_{0} < t_{1} < \cdots < t_{m} = T \}$ 使得对所有 $k = 0, \dots, m-1$ 和 $t \in [t_{k}, t_{k+1})$，都有 $G(t) \equiv G_{k}$，则 $G(\cdot)$ 被称为是一个 *阶梯过程* 。

由于上面定义的 $G$ 是循序可测的，因此它也是非预期的（对 $\omega$ 和 $t$ 联合可测蕴含对 $t$ 可测）。因此 $G_{k}$ 是 $\mathcal{F}(t_{k})$-可测的随机变量。

> **定义 4.19**
> 考虑阶梯过程 $G \in \mathbb{L}^{2}(0, T)$，则下面给出了 $G$ 在区间 $(0, T)$ 上的 Ito 随机积分：
> $$\int_{0}^{T} {G} \, \mathrm d{W} := \sum\limits_{k=0}^{m-1} G_{k}\big[ W(t_{k+1})-W(t_{k}) \big] $$
> 这是一个随机变量。

> **引理 4.20**
> 对所有 $a, b \in \mathbb{R}$ 以及所有阶梯过程 $G, H \in \mathbb{L}^{2}(0, T)$，Ito 随机积分有下面的性质
> 1. （线性性）$\displaystyle \int_{0}^{T} {aG + bH} \, \mathrm d{W} = a\int_{0}^{T} {G} \, \mathrm d{W} + b\int_{0}^{T} {H} \, \mathrm d{W}$
> 2. （期望为零）$\displaystyle E\left( \int_{0}^{T} {G} \, \mathrm d{W} \right) = 0$
> 3. $\displaystyle E\left[ \left( \int_{0}^{T} {G} \, \mathrm d{W} \right)^{2} \right]= E\left( \int_{0}^{T} {G^{2}} \, \mathrm d{t} \right)$

**证明.**
（1）可以看见，两个阶梯过程的线性组合是一个新的阶梯过程。
（2）
$$
\begin{align}
E\left( \int_{0}^{T} {G} \, \mathrm d{W} \right) &= E\left[ \sum\limits_{k=1}^{m-1} G_{k} \left[ W(t_{k+1}) - W(t_{k})\right]  \right] 
\end{align}
$$
由于 $G_{k}$ 是 $\mathcal{F}(t_{k})$-可测的，$W(t_{k+1}) - W(t_{k})$ 是 $\mathcal{W}^{+}(t_{k})$ 可测的。因此 $G_{k}$ 和 $W(t_{k+1}) - W(t_{k})$ 无关，因此有上式等于零
（3）先展开
$$
\begin{align}
E\left[ \left( \int_{0}^{T} {G} \, \mathrm d{W} \right)^{2} \right] &= E\left[ \sum\limits_{i,j} \underbrace{ G_{i} }_{ \in \mathcal{F}(t_{i}) } \cdot \underbrace{ G_{j} }_{ \in\mathcal{F}(t_{j}) } \cdot \underbrace{ [W(t_{i+1}) - W(t_{i})] }_{ \in\mathcal{W}^{+}(t_{i}) } \cdot\underbrace{ [W(t_{j+1}) - W(t_{j})] }_{ \in\mathcal{W}^{+}(t_{j}) } \right] \\
&= \sum\limits_{i,j}E\left[  \underbrace{ G_{i} }_{ \in \mathcal{F}(t_{i}) } \cdot \underbrace{ G_{j} }_{ \in\mathcal{F}(t_{j}) } \cdot \underbrace{ [W(t_{i+1}) - W(t_{i})] }_{ \in\mathcal{W}^{+}(t_{i}) } \cdot\underbrace{ [W(t_{j+1}) - W(t_{j})] }_{ \in\mathcal{W}^{+}(t_{j}) } \right] 
\end{align}
$$
其中 $i < j$ 时，有 $W(t_{j+1}) - W(t_{j})$ 和乘起来的其他三项相互独立，因此它们的期望为零。类似地也可以得到 $i > j$ 时的所有求和项期望都是零。因此可以简化为
$$
\begin{align}
E\left[ \left( \int_{0}^{T} {G} \, \mathrm d{W} \right)^{2} \right] &= \sum\limits_{i =1}^{m-1}E\left[  G_{i}^{2}  [W(t_{i+1}) - W(t_{i})]^{2} \right] \\
&= \sum\limits_{i =1}^{m-1}E(G_{i}^{2})E ([\underbrace{ W(t_{i+1}) - W(t_{i}) }_{ \sim N(0, t_{i+1}-t_{i}) }]^{2})  \\
&= \sum\limits_{i =1}^{m-1}E(G_{i}^{2})(t_{i+1}-t_{i}) = E\left( \int_{0}^{T} G^{2} \, \mathrm d t \right) \\
\end{align}
$$

有了阶梯过程后我们就考虑用阶梯过程逼近 $\mathbb{L}^{2}(0, T)$ 中的任意随机过程 $G$，这样就可以定义 $G$ 的随机 Ito 积分了。

> **引理 4.21 （用阶梯过程逼近任意二次可积的循序可测随机过程）**
> 任意 $G \in \mathbb{L}^{2}(0, T)$，都存在一列 $\mathbb{L}^{2}(0 ,T)$ 中的随机过程 $G^{(n)}$，使得
> $$E\left( \int_{0}^{T} |G - G^{(n)}| \, \mathrm dt \right) \rightarrow 0.$$

**证明思路.** 大概的思路就是对几乎一定连续的随机过程 $G$ ，对 $[0, T]$ 这个区间画格子，并定义 $$G^{(m)}(t) := \int_{0}^{t} {me^{m(s-t)}G(s)} \, \mathrm d{s} $$
所得的 $G^{(m)}(t)$ 对几乎所有 $\omega$ 都连续，且几乎一定二次收敛到 $G$。接着就用阶梯过程逼近 $G^{(m)}$。

### 4.2.3 Itô 积分的定义和性质

> **定义 4.22**
> 考虑某个 $G \in \mathbb{L}^{2}(0, T)$ 和 $\mathbb{L}^{2}(0, T)$ 中的一个阶梯过程序列 $\{ G^{n} \}_{n=1}^{\infty}$，则有当 $m, n \rightarrow \infty$ 时，有
> $$E\left[ \left( \int_{0}^{T} G^{(n)}-G^{(m)} \, \mathrm{d}W  \right)^{2}  \right] = E\left[ \int_{0}^{T}  \,  (G^{(n)} - G^{(m)})^{2}  \mathrm{d} t \right] \rightarrow  0$$
> 因此下面的极限在 $L^{2}(\Omega)$ 存在：
> $$\int_{0}^{T} G \, \mathrm{d}W \coloneqq \lim_{ n \to \infty } \int_{0}^{T} G^{(n)} \, \mathrm{d}W  $$
> 这就是 $G$ 的 Ito 随机积分。

可以检查这个定义是良好的：即它与收敛的序列无关。先前提到的阶梯过程的 Ito 随机积分在一般情况下也成立：

> **定理 4.23**
> 对所有 $a, b \in \mathbb{R}$ 以及所有 $G, H \in \mathbb{L}^{2}(0, T)$，Ito 随机积分有下面的性质
> 1. （线性性）$\displaystyle \int_{0}^{T} {aG + bH} \, \mathrm d{W} = a\int_{0}^{T} {G} \, \mathrm d{W} + b\int_{0}^{T} {H} \, \mathrm d{W}$
> 2. （期望为零）$\displaystyle E\left( \int_{0}^{T} {G} \, \mathrm d{W} \right) = 0$
> 3. $\displaystyle E\left[ \left( \int_{0}^{T} {G} \, \mathrm d{W} \right)^{2} \right]= E\left( \int_{0}^{T} {G^{2}} \, \mathrm d{t} \right)$

### 4.2.4 定义的推广

> **定义 4.14**
> 定义 $\mathbb{M}^{2}(0, T)$ 为所有满足下面条件的实值循序可测随机过程 $G(\cdot)$：
> $$\int_{0}^{T} G^{2} \, \mathrm{d}t < \infty \quad \text{a.s.} $$

我们可以把被积随机过程从 $\mathbb{L}^{2}(0, T)$ 扩展到 $\mathbb{M}^{2}(0, T)$，方法和先前类似，即使用 $\mathbb{M}^{2}(0, T)$ 中的阶梯过程逼近。这样的定义也 Riemann 和极限的视角也是相容的：

> **注释 4.15**
> 若 $G \in \mathbb{M}^{2}(0, T)$，且路径 $t \mapsto G(t, \omega)$ 对几乎所有 $\omega$ 连续。考虑划分 $P^{(n)}$，当其趋于零时，引理 4.9 中的 $R_{n}$ 当小区间中点 $\tau_{k}^{(k)}$ 取左端点时趋于 $G$ 在该区间上的随机 Ito 积分。

### 4.2.5 不定 Itô 积分

> **定义 4.16 （不定 Ito 积分）**
> 考虑 $G \in \mathbb{L}^{2}(0, T)$，定义其不定积分为
> $$I(t) \coloneqq \int_{0}^{t} G \, \mathrm{d}W, \quad 0 \leqslant t \leqslant T $$
> 注意 $I(0) = 0$。

下面给出不定积分的几个有用的性质，它是一个采样路径几乎一定连续的鞅。

> **定理 4.17**
> 考虑 $G \in \mathbb{L}^{2}(0, T)$，则其不定积分 $I(\cdot)$ 是一个鞅，且它存在一个采样路径几乎一定连续的版本。

以后我们在提到 $I(\cdot)$ 时，就是指这个性质非常好的版本。

## 4.3 Itô 积分的链式法则和乘积法则
### 4.3.1 链式法则

首先给出一些方便的记号。

> **定义 4.18**
> 假设随机变量 $X(\cdot)$ 满足存在 $F \in \mathbb{L}^{1}(0, T)$ 和 $G \in \mathbb{L}^{2}(0, T)$，和 $0 \leqslant s \leqslant r \leqslant T$，使得
> $$X(r) = X(s) + \int_{r}^{s} F \, \mathrm{d}t + \int_{r}^{s} G \, \mathrm{d}W  $$
> 我们就说 $X(\cdot)$ 对于 $t \in [0, T]$，满足下面形式的 “随机微分”
> $$\mathrm{d} X = F \mathrm{d} t + G \mathrm{d} W$$

需要注意的是，这里面的 $\mathrm{d}X$，$\mathrm{d}t$ 和 $\mathrm{d} W$ 单独拿出来都没有实际意义，需要和积分配套使用。接下来我们就可以叙述 Ito 链式法则了。

> **定理 4.19 （Ito 链式法则）**
> 若随机变量 $X(\cdot)$ 有随机微分 $\mathrm{d} X = F \mathrm{d}t + G \mathrm{d} W$，其中 $F \in \mathbb{L}^{1}(0, T)$ 和 $G \in \mathbb{L}^{2}(0, T)$。考虑函数 
> $$\begin{align} u: \mathbb{R} \times [0, T] &\rightarrow  \mathbb{R}\\(x, t) &\mapsto u(x, t) \end{align}$$
> 且 $u$ 的偏导数 $u_{x}$，$u_{t}$ 以及 $u_{xx}$ 都存在且连续。则 $Y(t) = u(X(t), t)$ 有随机微分
> $$\boxed{ \begin{align} \mathrm{d} u(X(t), t) &= u_{t} \mathrm{d}t + u_{x}\mathrm{d}X + \frac{1}{2}u_{x x}G^{2}\mathrm{d}t\\&=\left( u_{t} + u_{x} F + \frac{1}{2}u_{x x} G^{2} \right)\mathrm{d} t + u_{x} G \mathrm{d} W\end{align} }$$
> 其中 $u$ 的各偏导数的参数都是 $(X(t), t)$。

> **注释 4.20**
> 换言之，沿用上面的记号，链式法则说的是
> $$\begin{align}
Y(r) - Y(s) &= u(X(r), r) - u(X(s), s)\\&= \int_{s}^{r} u_{t} + u_{x} F + \frac{1}{2}u_{x x}G^{2} \, \mathrm{d}t + \int_{r}^{s} u_{x} G \, \mathrm{d}W \quad \text{a.s.}  \end{align}$$

### 4.3.2 链式法则的应用

我们先不证明上面的链式法则，它要用到下面要讲的乘积法则。我们先接受它，然后看一下几个典型的有趣例子

> **示例 4.21 （单项式）**
> 首先考虑简单的情况。假设 $X(\cdot) = W(\cdot)$，以及 $u(x) = x^{m}$。根据随机微分的定义，有 $\mathrm{d}X = 0\mathrm{d}t + 1 \mathrm{d} W$，即 $F \equiv 0, G \equiv 1$。根据 Ito 链式法则，就有
> $$\begin{align}
\mathrm{d} (W^{m}) &=\left( u_{t} + u_{x} F + \frac{1}{2}u_{x x} G^{2} \right)\mathrm{d} t + u_{x} G \mathrm{d} W\\ &=\left( 0 + m X^{m-1} \cdot 0 + \frac{1}{2} m(m-1)W^{m-2} 1^{2} \right)\mathrm{d} t + (m X^{m-1} \cdot 1) \mathrm{d} W\\&= \frac{1}{2} m(m-1) W^{m-2} \mathrm{d}t + m W^{m-1} \mathrm{d} W
\end{align}$$
> 特别地，当 $m=2$ 时，有 $\mathrm{d}(W^{2}) = 2W \mathrm{d} W + \mathrm{d}t$，写成积分形式就是
> $$\int_{s}^{r} W \, \mathrm{d}W = \frac{W^{2}(r) - W^{2}(s)}{2} - \frac{r-s}{2}$$
> 这又回到了 Ito 积分的定义。

> **示例 4.22**
> 接下来考虑 $\displaystyle u = \exp\left\{  \lambda x - \frac{\lambda^{2}t}{2}  \right\}$，$X(\cdot)$ 和上面一样。因此有
> $$\begin{align}\mathrm{d} u &=\left( u_{t} + u_{x} F + \frac{1}{2}u_{x x} G^{2} \right)\mathrm{d} t + u_{x} G \mathrm{d} W\\ &=\left( -\frac{\lambda^{2}}{2}u + 0 + \frac{\lambda^{2}}{2}u \right)\mathrm{d} t + \lambda u  \mathrm{d} W\\&= \lambda u  \mathrm{d} W\end{align} $$
> 因此它还可以写成下面的随机微分方程形式：
> $$\begin{align}\mathrm{d} Y &= \lambda Y \mathrm{d} W\\Y(0) &= 1\end{align}$$

接下来看一个稍微复杂一些的例子，但读者会发现，这里的 Hermite 多项式起到了 Taylor 展开里面类似 $\displaystyle \frac{x^{n}}{n!}$ 这样的功效。

> **定义 4.23 （Hermite 多项式）**
> 定义 Hermite 多项式 $H_{n}(x, t), n = 0, 1, \dots$ 为
> $$H_{n}(x, t) \coloneqq \frac{(-t)^{n}}{n!} \exp\left\{ \frac{x^{2}}{2t} \right\} \displaystyle \frac{ \mathrm{d}^{n} }{ \mathrm{d}x^{n} } \exp\left\{ \frac{-x^{2}}{2t} \right\}$$

> **定理 4.24 （Hermite 多项式和随机积分）**
> $$\mathrm{d} H_{n+1}(W, t) = H_{n}(W, t) \mathrm{d} W$$

**证明.**
我们知道 $\displaystyle \mathrm{d} \frac{x^{n}}{n!} = \frac{x^{n-1}}{(n-1)!} \mathrm{d}x$，它的形式和这个很像。我们也可以考虑把某个东西做类似 Taylor 展开一样的展开。在这里我们的选择是 $u(x, \lambda)= \displaystyle \exp \left\{- \frac{(x - \lambda t)^{2}}{2t}  \right\}$。
在 Taylor 展开中，我们有 $\displaystyle \displaystyle \left.\frac{ \mathrm{d}^{n}}{ \mathrm{d}x^{n} } e^{x}\right|_{x=0} = n! \cdot \frac{x^{n}}{n!}$，这里我们也考察类似的项。由于此时变元换成了 $\lambda$，因此我们需要考察 $\lambda = 0$ 时的情形。我们首先从一阶导开始。
$$
\frac{\partial}{\partial\lambda} u(x, \lambda) = (x-\lambda t) u(x, \lambda)
$$
另一方面
$$
\frac{\partial}{\partial x} u(x, \lambda) = -\frac{x-\lambda t}{t} u(x, \lambda)
$$
因此有 $\displaystyle \frac{\partial}{\partial\lambda} u(x, \lambda) = (-t) \cdot \frac{\partial}{\partial x}u(x, \lambda).$ 接下来我们猜想
$$
\frac{\partial^{n}}{\partial \lambda^{n}} u(x, \lambda) = (-t)^{n} \frac{\partial^{n}}{\partial x^{n}}u(x, \lambda)
$$
$n=0,1$ 时已经验证过（或不言自明），接下来用归纳法。假设 $n-1$ 时成立，有
$$
\begin{align}
\frac{\partial^{n}}{\partial \lambda^{n}} u(x, \lambda) &= \frac{\partial}{\partial\lambda} \frac{\partial^{n-1}}{\partial \lambda^{n-1}} u(x, \lambda)\\
&= (-t)^{n-1} \frac{\partial}{\partial\lambda} \frac{\partial^{n-1}}{\partial x^{n-1}}u(x, \lambda)\\
&= (-t)^{n-1} \frac{\partial^{n-1}}{\partial x^{n-1}} \frac{\partial}{\partial\lambda} u(x, \lambda) & u \text{ 光滑}\\
&= (-t)^{n-1} \frac{\partial^{n-1}}{\partial x^{n-1}} (-t) \frac{\partial}{\partial x} u(x, \lambda)\\
&= \frac{\partial^{n}}{\partial x^{n}} u(x, \lambda)
\end{align}
$$
写开来就是
$$
\frac{\partial^{n}}{\partial \lambda^{n}} \exp \left\{- \frac{(x - \lambda t)^{2}}{2t}  \right\} = (-t)^{n} \frac{\partial^{n}}{\partial x^{n}} \exp \left\{- \frac{(x - \lambda t)^{2}}{2t}  \right\}
$$
同时对两侧令 $\lambda = 0$，就有
$$
\begin{align}
\left.\frac{\partial^{n}}{\partial \lambda^{n}} \exp \left\{- \frac{(x - \lambda t)^{2}}{2t}  \right\}\right|_{\lambda = 0} &= \left.(-t)^{n} \frac{\partial^{n}}{\partial x^{n}} \exp \left\{- \frac{(x - \lambda t)^{2}}{2t}  \right\}\right|_{\lambda = 0}\\
&= (-t)^{n} \frac{\mathrm{d}^{n}}{\mathrm{d} x^{n}} \exp \left\{- \frac{x^{2}}{2t}  \right\} 
\end{align}
$$
现在我们需要凑出 Hermite 多项式的形式：
$$
\begin{align}
H_{n}(x, t) &= \frac{(-t)^{n}}{\color{blue} n!} \cdot {\color{blue} \exp \left\{- \frac{x^{2}}{2t}  \right\} } \frac{\mathrm{d}^{n}}{\mathrm{d} x^{n}} \exp \left\{- \frac{x^{2}}{2t}  \right\} \\
&= \frac{1}{n!} \left.\frac{\partial^{n}}{\partial \lambda^{n}} \exp \left\{ \lambda x-\frac{\lambda^{2} t}{2}  \right\}\right|_{\lambda = 0}
\end{align}
$$
因此 $\displaystyle \exp \left\{ \lambda x-\frac{\lambda^{2} t}{2}  \right\}$ 就可以有下面的展开
$$
Y(x) = \exp \left\{ \lambda x-\frac{\lambda^{2} t}{2}  \right\} = \sum\limits_{n = 0}^{\infty} n! H_{n}(x, t)
$$
此时将 $x$ 替换为 Brown 运动 $W(t)$，根据上个例子的结论，有
$$
\left\{ 
\begin{align}
\mathrm{d}Y &= \lambda Y \mathrm{d}W\\
Y(0) &= 1
\end{align}
\right.
$$
因此
$$
Y(t) = Y(0) + \int_{0}^{t} Y \, \mathrm dW 
$$
把上面的展开代进来，有
$$
\begin{align}
\sum\limits_{n=0}^{\infty} \lambda^{n} H_{n}(X(t), t) &= 1 +  \int_{0}^{t} \sum\limits_{n=0}^{\infty} \lambda^{n+1} H_{n}(X(t), t) \, \mathrm dW \\
&= 1 + \sum\limits_{n=1}^{\infty} \lambda^{n} \int_{0}^{t}  H_{n-1}(X(t), t) \, \mathrm dW 
\end{align}
$$
因此对所有 $n \in \mathbb{N}_{> 0}$，比对 $\lambda^{n}$ 的系数，有
$$
H_{n}(X(t), t) = H_{n-1}(X(t), t)\mathrm{d} W
$$

### 4.3.3 乘积法则

我们先给出两个简单的结论。

> **引理 4.25**
> 1. $\mathrm{d} (W^{2}) = 2W\mathrm{d} W + \mathrm{d}t$
> 2. $\mathrm{d}(tW) = W\mathrm{d}t + t\mathrm{d}W$

**证明.**
根据之前的内容，（1）是显然的，现在证明 (2)。我们可以把两边分别写成 Riemann 和的极限的形式。选取一个细度趋于零的划分 $P^{(n)}$，左边可以写成
$$
\int_{0}^{r}  \, \mathrm d{(tW)} = rW(r) = \sum\limits_{k=0}^{m_{n} - 1} [t_{k+1}^{n}W(t_{k+1}^{n}) - t_{k}^{n}W(t_{k}^{n})] 
$$
右边的第一项的区间中点用右侧端点，第二项用左侧端点。因此可以写成下面的形式，我们发现和上面的 Riemann 和完全一致。
$$
\begin{align}
\int_{0}^{r} W \, \mathrm d{t} + \int_{0}^{r} t \, \mathrm d{W} 
&= \sum\limits_{k=0}^{m_{n} - 1} W(t_{k+1}^{n})[t_{k+1}^{n} - t_{k}^{n}]  + \sum\limits_{k=0}^{m_{n} - 1} t_{k}^{n}[W(t_{k+1}^{n}) - W(t_{k}^{n})] \\
&= \sum\limits_{k=0}^{m_{n} - 1} [t_{k+1}^{n}W(t_{k+1}^{n}) - t_{k}^{n}W(t_{k}^{n})] 
\end{align} 
$$

现在给出一般形式的乘积法则

> **定理 4.26**
> 假设两个随机变量 $X_{1}$ 和 $X_{2}$ 满足
> $$\begin{align} \mathrm{d} X_{1} &= F_{1} \mathrm{d}t + G_{1}\mathrm{d}W\\ \mathrm{d} X_{2} &= F_{1} \mathrm{d}t + G_{1}\mathrm{d}W\\ \end{align}$$
> 其中 $F_{1}, F_{2} \in \mathbb{L}^{1}(0, T)$，$G_{1}, G_{2} \in \mathbb{L}^{2}(0, T)$，则 $X_{1}X_{2}$ 有下面的随机微分
> $$\mathrm{d}(X_{1}X_{2}) = X_{2}\mathrm{d}X_{1} + X_{1}\mathrm{d}X_{2} + G_{1}G_{2}\mathrm{d}t$$

**证明.**
分三步。我们要证明乘积法则对所有的 $F_{i}$ 和 $G_{i}$ 都成立，而 $F_{i}$ 和 $G_{i}$ 都可以在各自的空间中被各自空间中的阶梯过程逼近。

<font color="red">（第一步）</font>
我们先从最简单的情况开始。选一个 $r \in [0, T]$，且假设 $X_{1}(0) = X_{2}(0)$，$F_{i}$ 和 $G_{i}$ 是对时间无关的 $\mathcal{F}(0)$-可测的随机过程。根据给定条件，有
$$
\begin{align}
X_{i}(t) 
&= \int_{0}^{t} \, \mathrm d X_{i}(t)\\ 
&= \int_{0}^{t} F_{i} \, \mathrm dt + \int_{0}^{t} G_{i} \, \mathrm dW\\
&= F_{i}\int_{0}^{t} \, \mathrm dt +  G_{i}\int_{0}^{t} \, \mathrm dW\\
&= F_{i}t + G_{i}W(t).
\end{align}
$$
现在考虑等式右侧的积分
$$
\begin{align}
&\,\int_{0}^{r} X_{2}\mathrm{d}X_{1} + X_{1}\mathrm{d}X_{2} + G_{1}G_{2}\mathrm{d}t \\
=&\,\int_{0}^{r} X_{2}(F_{1} \mathrm{d}t + G_{1}\mathrm{d}W) + X_{1}(F_{2} \mathrm{d}t + G_{2}\mathrm{d}W) + G_{1}G_{2}\mathrm{d}t \\
=&\,\int_{0}^{r} F_{1}X_{2} + F_{2}X_{1} + G_{1}G_{2} \, \mathrm dt + \int_{0}^{r} G_{1}X_{2} + G_{2}X_{1} \, \mathrm d{W}\\
=&\,\int_{0}^{r} F_{1}({\color{red} F_{2}t }  + {\color{blue} G_{2} } W) + F_{2}({\color{red} F_{1}t }  + {\color{blue} G_{1} } W) + G_{1}G_{2} \, \mathrm dt \\&+ \int_{0}^{r} G_{1}({\color{blue} F_{2} }t + {\color{green} G_{2}W } ) + G_{2}({\color{blue} F_{1} }t + {\color{green} G_{1}W }) \, \mathrm d{W}\\
=&\,2\int_{0}^{r} {\color{red} F_{1}F_{2}t} \, \mathrm d t + ({\color{blue} F_{1}G_{2} + F_{2}G_{1} } )\left( \int_{0}^{r} {W} \, \mathrm d{t} + \int_{0}^{r} {t} \, \mathrm d{W}  \right) \\&+ 2\int_{0}^{r} {\color{green} G_{1}G_{2}W }  \, \mathrm d{W} + G_{1}G_{2}r \\
=&\,F_{1}F_{2}r^{2} + (F_{1}G_{2} + F_{2}G_{1})rW(r) + G_{1}G_{2} (W(r)^{2} - \cancel{ r }) + \cancel{ G_{1}G_{2}r }\\
=&\,X_{1}(r)X_{2}(r)
\end{align}
$$
接下来是 $s \geqslant 0$，$X_{1}(s)$ 和 $X_{2}(s)$ 任意，$F_{i}$ 和 $G_{i}$ 是 $\mathcal{F}(s)$-可测的过程的情况，和上面的证明类似，不再赘述。

<font color="red">（第二步）</font>
对于阶梯过程 $F_{i}$ 和 $G_{i}$，我们可以对每一个阶梯区间 $[t_{k}, t_{k+1})$ 用上一步的结果，然后加起来即可

<font color="red">（第三步）</font>
我们可以在对应的空间中分别选出一列收敛于任意的 $F_{i}$ 和 $G_{i}$ 的阶梯过程 $F^{(n)}_{i}$ 和 $G^{(n)}_{i}$，定义
$$
X_{i}^{(n)}(t) := X_{i}(0) + \int_{0}^{t} F_{i}^{(n)} \, \mathrm d{s} + \int_{0}^{t} G_{i}^{(n)} \, \mathrm d{W}  
$$
用前两步的结果，然后令 $n \rightarrow \infty$，就能证明定理。

> **注释 4.27**
> 乘积法则中的 $G_{1}G_{2}\mathrm{d}t$ 称为 Ito 校正项

> **注释 4.28**
> 乘积公式可以导出下面的 Ito 分部积分公式：
> $$\int_{s}^{r} X_{2} \, \mathrm{d}X_{1} = X_{1}(t)X_{2}(t)|^{r}_{s} - \int_{s}^{r} X_{1} \, \mathrm{d}X_{2} - \int_{r}^{s} G_{1}G_{2} \, \mathrm{d}t   $$

> **注释 4.29**
> 可以看到，如果 $G_{1}$ 或 $G_{2}$ 为零，我们的结论就退化为通常微积分中的分部积分公式。如果进一步令 $X_{1}(\cdot) = W(\cdot)$，$X_{2}(\cdot) = g \in \mathscr{C}^{1}$，其中后者为确定函数，且满足 $g(0) = g(T) = 0$，我们就回到了先前 Paley-Wiener-Zygmund 的随机积分定义

### 4.3.4 链式法则的证明

有了乘积法则之后，我们来证明 Ito 链式法则。我们再把链式法则写一遍

> **定理 4.19 （Ito 链式法则）**
> 若随机变量 $X(\cdot)$ 有随机微分 $\mathrm{d} X = F \mathrm{d}t + G \mathrm{d} W$，其中 $F \in \mathbb{L}^{1}(0, T)$ 和 $G \in \mathbb{L}^{2}(0, T)$。考虑函数 
> $$\begin{align} u: \mathbb{R} \times [0, T] &\rightarrow  \mathbb{R}\\(x, t) &\mapsto u(x, t) \end{align}$$
> 且 $u$ 的偏导数 $u_{x}$，$u_{t}$ 以及 $u_{xx}$ 都存在且连续。则 $Y(t) = u(X(t), t)$ 有随机微分
> $$\boxed{ \begin{align} \mathrm{d} u(X(t), t) &= u_{t} \mathrm{d}t + u_{x}\mathrm{d}X + \frac{1}{2}u_{x x}G^{2}\mathrm{d}t\\&=\left( u_{t} + u_{x} F + \frac{1}{2}u_{x x} G^{2} \right)\mathrm{d} t + u_{x} G \mathrm{d} W\end{align} }$$
> 其中 $u$ 的各偏导数的参数都是 $(X(t), t)$。

**证明.**
链式法则的证明也分三步。首先考虑最简单的情况，即 $u$ 为单项式的情形，然后证明多项式的情形，最后用多项式逼近任意的 $u$ （和它的各个偏导数）。

<font color="red">（第一步）</font>
现在我们来证明链式法则的第一个例子中的情形，即 $u(x) = x^{m}, m=0, 1, \dots$ 我们要证明的是
$$
\begin{aligned}
\mathrm{d}(X^{m}) &= u_{t}\mathrm{d}t + u_{x} \mathrm{d}X + \frac{1}{2} u_{x x}G^{2}\mathrm{d}t \\
&= mX^{m-1}\mathrm{d}X + \frac{m(m-1)}{2} X^{m-2}G^{2}\mathrm{d}t
\end{aligned}
$$
当 $m = 0$ 和 $m=1$ 时，我们可以很容易地验证上式成立。现在用数学归纳法，假设 $m=n-1$ 时上式成立，并假设 $\mathrm{d}X = F \mathrm{d} t +G \mathrm{d} W$，因此
$$
\begin{align}
\mathrm{d}(X^{m-1}) &= (m-1)X^{m-2}\mathrm{d}X + \frac{(m-1)(m-2)}{2} X^{m-3}G^{2}\mathrm{d}t\\
&= (m-1)X^{m-2}(F\mathrm{d} t +G \mathrm{d} W) + \frac{(m-1)(m-2)}{2} X^{m-3}G^{2}\mathrm{d}t\\
&= \square\,\mathrm{d}t + (m-1)X^{m-2}G \mathrm{d} W. \quad \quad 此时我们不用关心~\mathrm{d}t~的系数
\end{align}
$$
进而我们可以使用乘积法则
$$
\begin{aligned}
\mathrm{d} (X^{m}) &= \mathrm{d}(X \cdot X^{m-1})\\
&= X \mathrm{d} (X^{m-1}) + X^{m-1}\mathrm{d} X + (m-1)X^{m-2}G^{2}\mathrm{d}t\\
&= X \left[ (m-1)X^{m-2}(F\mathrm{d} t +G \mathrm{d} W) + \frac{(m-1)(m-2)}{2} X^{m-3}G^{2}\mathrm{d}t \right]\\
&\quad + X^{m-1}\mathrm{d} X + (m-1)X^{m-2}G^{2}\mathrm{d}t\\
&= mX^{m-1}\mathrm{d}X + \frac{m(m-1)}{2} X^{m-2}G^{2}\mathrm{d}t
\end{aligned}
$$
这样我们就证明了 $u(x) = x^{m}$ 的情形。根据微分算子的线性性，该结果对任意的多项式 $f \in \mathbb{F}[x]$ 成立。

<font color="red">（第二步）</font>
接下来考虑可以写成两个多项式乘积的情况：$u(x, t) = f(x)g(t)$，其中 $f$ 和 $g$ 都是多项式，这是因为任何 $u \in \mathbb{F}[x, t]$ 都可以写成 $x$ 和 $t$ 单项式乘积的有限线性组合。由第一步，我们有
$$
\begin{align}
\mathrm{d}[f(X)] &= \square \mathrm{d} W + \square \mathrm{d}t\\
\mathrm{d}[g(t)] &= 0 \mathrm{d}W + g_{t}(t) \mathrm{d}t
\end{align}
$$
因此
$$
\begin{align}
\mathrm{d}(u(X, t)) 
&= \mathrm{d}(f(X)g(t))\\
&= f(X) \mathrm{d} [g(t)] + g(t) \mathrm{d} [f(X)] + (0\cdot \square)\mathrm{d}t\\
&= f(X)g'\mathrm{d}t + g(t)\left[ f'(X)\mathrm{d}X + \frac{1}{2} f''(X)G^{2}\mathrm{d}t \right]\\
&= f(X)g'(t)\mathrm{d}t + g(t)f'(X)\mathrm{d}X + \frac{1}{2} g(t)f''(X)G^{2}\mathrm{d}t \\
&= u_{t}\mathrm{d}t + u_{x}\mathrm{d}X + \frac{1}{2}u_{x x}G^{2}\mathrm{d}t
\end{align}
$$

<font color="red">（第三步）</font>
最后一步就是逼近。对任意满足定理条件的 $u$，都存在一个多项式序列 $u^{(n)} \in \mathbb{F}[x, t]$，使得当 $n \rightarrow \infty$ 时，有
$$
u(n) \rightarrow u, \quad u_{t}^{(n)} \rightarrow  u_{t}, \quad u^{(n)}_{x} \rightarrow  u_{x}, \quad u^{(n)}_{x x} \rightarrow  u_{x x}
$$
因此我们在第二步的基础上对 $n$ 求极限即可。

### 4.3.5 链式法则的拓展形式

首先引入一些记号

> **约定 4.30**
> 我们将 $\mathbb{R}^{n}$ 中的点 $\boldsymbol{x}$ 写为 $\boldsymbol{x} = [x_{1}, \dots, x_{n}]^{\top}$
> 考虑实值函数 $u: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{R}$，我们有下面的偏导数简记号
> $$u_{t} = \displaystyle \frac{ \partial u }{ \partial t },\quad u_{x_{i}} = \displaystyle \frac{ \partial u }{ \partial x_{i} } , \quad u_{x_{i} x_{j}} = \displaystyle \frac{ \partial u }{ \partial x_{i}x_{j} } , \dots$$
> 其中 $i, j = 1, \dots, n$。

我们现在给出 Ito 链式法则的一般形式

> **定理 4.31 （Ito 链式法则）**
> 假设一列随机过程 $X^{(i)}$ 满足分别存在一列 $F^{(i)} \in \mathbb{L}^{1}(0, T)$ 和 $G^{(i)} \in \mathbb{L}^{2}(0, T)$，使得对所有 $i = 1, \dots, n$ 都有
> $$\mathrm{d}X^{(i)} = F^{(i)}\mathrm{d}t + G^{(i)}\mathrm{d}W$$
> 现在考虑直至二次偏导连续的 $u: \mathbb{R}^{n} \times [0, T] \rightarrow \mathbb{R}$，有
> $$\mathrm{d}\big[ u(X^{(1)}, \dots, X^{(n)}, t) \big] = u_{t}\mathrm{d}t + \sum\limits_{k=1}^{n} u_{x_{k}}\mathrm{d}X^{(i)} + \frac{1}{2}\sum\limits_{i, j = 1}^{n} u_{x_{i}}u_{x_{j}} G^{(i)}G^{(j)}\mathrm{d}t.$$

这个定理也可以使用一维情形下证明的相似思路完成。即考虑 $u$ 用下面的多项式逼近：
$$
u^{(n)} = \sum\limits_{k=1}^{m} g(t)\prod\limits_{i=1}^{n} f_{i}(x_{i})
$$
其中 $g$ 和 $f_{i}$ 都是多项式。

## 4.4 高维形式的 Itô 积分和积分法则

### 4.4.1 定义和记号

> **记号 4.32**
> 1. 记 $m$ 维 Brown 运功为 $\boldsymbol{W}(\cdot) = [W^{(1)}(\cdot), \dots, W^{(m)}(\cdot)]$
> 2. 设 $\mathcal{F}(\cdot)$ 是一族非预期的 $\sigma$-代数，意思是对所有 $t \geqslant x \geqslant 0$，它满足
> 	* $\mathcal{F}(s) \subset \mathcal{F}(t)$
> 	* $\mathcal{W}(t) = \mathcal{U}(\boldsymbol{W}(s) | 0 \leqslant s \leqslant t) \subset \mathcal{F}(t)$
> 	* $\mathcal{F}(t)$ 和 $\mathcal{W}^{+}(t) \coloneqq \mathcal{U}(\boldsymbol{W}(s) - \boldsymbol{W}(t)| t \leqslant s < \infty)$ 无关

接下来定义循序可测的矩阵值随机过程和它的随机积分的定义。

> **定义 4.33 （矩阵值和向量值随机过程）**
> 一个矩阵值（$\mathbb{M}^{n \times m}$）随机过程 $\boldsymbol{G} = (G^{(i,j)})_{n \times m}$ 若满足对所有 $i, j$，都有 $G^{(i,j)} \in \mathbb{L}^{2}(0, T)$，我们称 $\boldsymbol{G} \in \mathbb{L}_{n \times m}^{2}(0, T)$；
> 一个向量值（$\mathbb{R}^{n}$）随机过程 $\boldsymbol{F} = [F^{(1)}, \dots, F^{(n)}]$，若满足对所有 $i$ ，都有 $F^{(i)} \in \mathbb{L}^{1}(0, T)$，我们称 $\boldsymbol{F} \in \mathbb{L}^{1}_{n}(0, T)$。

满足条件的矩阵值随机过程的随机积分是和矩阵乘法类似规则的分量组合的随机积分之和：

> **定义 4.34 （矩阵值随机过程的随机积分）**
> 假设 $\boldsymbol{G} \in \mathbb{L}^{(2)}_{n \times m}(0, T)$，定义其随机积分 $\displaystyle \int_{0}^{T} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W}$ 是一个向量值（$\mathbb{R}^{n}$）随机过程，其第 $i$ 个分量为
> $$\sum\limits_{j=1}^{m} \int_{0}^{T} G^{(i,j)} \, \mathrm{d}W^{(j)} $$

利用前文的老办法，用阶梯过程逼近，可以证明

> **引理 4.35**
> 假设 $\boldsymbol{G} \in \mathbb{L}^{(2)}_{n \times m}(0, T)$，有
> 1. $\displaystyle E\left[ \int_{0}^{T} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W} \right] = 0$
> 2. $\displaystyle E\left[ \left| \int_{0}^{T} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W} \right|^{2} \right] = \mathbb{E}\left[ \int_{0}^{T} |\boldsymbol{G}|^{2} \, \mathrm{d}t \right]$，其中 $\displaystyle |\boldsymbol{G}|^{2} \coloneqq \sum\limits_{{\scriptstyle 1 \leqslant i \leqslant n}\atop{\scriptstyle i \leqslant j \leqslant n}} |G^{(i,j)}|^{2}$

接着我们给出向量值随机过程对应的随机微分记号。

> **定义 4.36（向量值过程的随机微分）**
> 考虑向量（$\mathbb{R}^{n}$）值的过程 $\boldsymbol{X}(\cdot) = [X^{(1)}, \dots, X^{(n)}]$，如果存在 $\boldsymbol{F} \in \mathbb{L}_{n}^{1}(0, T)$ 和 $\boldsymbol{G} \in \mathbb{L}_{n \times m}^{2}(0, T)$，对所有 $0 \leqslant s \leqslant r \leqslant T$，都有
> $$\boldsymbol{X}(r) = \boldsymbol{X}(s) + \int_{s}^{r} \boldsymbol{F} \, \mathrm{d}t + \int_{s}^{r} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W}  $$
> 则称 $\boldsymbol{X}(\cdot)$ 具有随机微分 $\mathrm{d} \boldsymbol{X} = \boldsymbol{F} \mathrm{d} t + \boldsymbol{G} \mathrm{d} \boldsymbol{W}$，这表示对 $i = 1, \dots, n$，有
> $$\mathrm{d} X^{(i)} = F^{(i)}\mathrm{d} t + \sum\limits_{j=1}^{m} G^{(i,j)} \mathrm{d} W^{(j)}$$

### 4.4.2 乘积法则和链式法则

在介绍一般情形下的链式法则和乘积法则之前，需要给出下面的引理：

> **引理 4.37**
> 考虑两个独立的一维 Brown 运动 $W(\cdot)$ 和 $\overline{W}(\cdot)$，有
> $$\mathrm{d} (W \overline{W}) = W \mathrm{d}\overline{W} + \overline{W} \mathrm{d} W$$
> 注意相比于先前的 $\mathrm{d} (W^{2})$ 的情形，校正项 $\mathrm{d} t$ 没有了。

**证明**.
令 $\displaystyle X(t) = \frac{W(t) + \overline{W}(t)}{\sqrt{ 2 }}$，容易验证它也是个一维 Brown 运动。根据一维的 Ito 链式法则，有
$$
\begin{align}
\mathrm{d} (X^{2}) &= 2X \mathrm{d} X + \mathrm{d}t\\
\mathrm{d} (W^{2}) &= 2 W \mathrm{d} W + \mathrm{d} t\\
\mathrm{d} (\overline{W}^{2}) &= 2\overline{W} \mathrm{d} \overline{W} + \mathrm{d} t
\end{align}
$$
然后根据乘积法则，有
$$
\begin{align}
\mathrm{d} (W \overline{W}) &= \mathrm{d}\left[ X^{2} - \frac{1}{2}W^{2} - \frac{1}{2}\overline{W}^{2} \right]\\
&= 2X \mathrm{d} X - W \mathrm{d} W - \overline{W} \mathrm{d} \overline{W}\\
&= (W + \overline{W})(\mathrm{d} W + \mathrm{d} \overline{W}) - W \mathrm{d} W - \overline{W} \mathrm{d} \overline{W}\\
&= W \mathrm{d} \overline{W} + \overline{W} \mathrm{d} W
\end{align}
$$

接着我们需要下面稍稍推广一些的乘积法则：

> **引理 4.38 （多个 Brown 运动的乘积法则）**
> 假设 $X_{1}$ 和 $X_{2}$ 有如下形式的随机微分
> $$\begin{align} \mathrm{d} X_{1} &= F_{1} \mathrm{d} t + \sum\limits_{k=1}^{m} G_{1}^{(k)} \mathrm{d} W^{(k)}\\ \mathrm{d} X_{2} &= F_{2} \mathrm{d} t + \sum\limits_{l=1}^{m} G_{2}^{(l)} \mathrm{d} W^{(k)}\\ \end{align}$$
> 其中 $F_{i} \in \mathbb{L}^{1}(0, T)$，$G_{i}^{k} \in \mathbb{L}^{2}(0, T)$，于是
> $$\mathrm{d} (X_{1}X_{2}) = X_{1}\mathrm{d}X_{2} + X_{2}\mathrm{d}X_{1} + \sum\limits_{k=1}^{m} G_{1}^{(k)}G_{2}^{(k)} \mathrm{d} t$$

注意等式右侧变成了对角求和，这是因为我们可以从前面一个引理中得到对于 $W^{(i)}$ 和 $W^{(j)}$，有
$$
\mathrm{d}(W^{(i)}W^{(j)}) = W^{(i)} \mathrm{d} W^{(j)} + W^{(j)} \mathrm{d} W^{(i)} + \delta_{i,j} \mathrm{d} t
$$
然后可以用和一维情形相似的方法证明。

至于链式法则，此时的 $u$ 的定义域从 $\mathbb{R}$ 变成了 $\mathbb{R}^{m}$，我们同样可以使用归纳法先证明它的多项式 $x_{1}^{k_{1}}\cdots x_{m}^{k_{m}}$ 情形下是正确的，然后利用线性性得到其对任意 $\mathbb{R}^{m}$ 上的多项式成立，最后用多项式进行逼近。

> **注解 4.39**
> 考虑满足下面随机微分的向量值过程 $\boldsymbol{X}$：
> $$\mathrm{d} \boldsymbol{X} = \boldsymbol{F} \mathrm{d} t + \boldsymbol{G} \mathrm{d} \boldsymbol{W}$$
> 我们常常记 $\boldsymbol{H} = \boldsymbol{G}\boldsymbol{G}^{\top}$，Ito 链式法则既可以写成
> $$\mathrm{d} [u(\boldsymbol{X}, t)] = \left[ u_{t} + Du \cdot \boldsymbol{F} + \frac{1}{2} (\boldsymbol{G}\boldsymbol{G}^{\top}) : (D^{2}u) \right] \mathrm{d} t +  Du \cdot (\boldsymbol{G} \mathrm{d} \boldsymbol{W}) $$
> 其中 $D$ 是微分算子，$Du$ 得到函数 $u$ 的梯度，$D^{2}u$ 得到函数 $u$ 的 Hessian 矩阵。其中 $\cdot$ 是指梯度和向量的自然配对（内积），$:$ 表示矩阵之间的逐项乘积（Hadamard 积）。

### 4.4.3 乘积法则和链式法则的助记法
**链式法则**
考虑 $\boldsymbol{X}$，满足下面的随机微分
$$
\mathrm{d} \boldsymbol{X} = \boldsymbol{F} \mathrm{d} t + \boldsymbol{G} \mathrm{d} \boldsymbol{W}
$$
首先形式地计算
$$
\mathrm{d} [u(\boldsymbol{X}, t)] = u_{t} \mathrm{d} t + \sum\limits_{i=1}^{n} u_{x_{i}} \mathrm{d} X^{(i)} + \frac{1}{2} \sum\limits_{i,j=1}^{n} u_{x_{i},x_{j}}\mathrm{d} X^{(i)} \mathrm{d} X^{(j)}
$$
然后根据下面的规则化简 $\mathrm{d} X^{(i)} \mathrm{d} X^{(j)}$：
$$
\begin{cases}
(\mathrm{d}t)^{2} &= 0\\
\mathrm{d} t \mathrm{d} W^{(k)} &= 0\\
\mathrm{d} W^{(k)} \mathrm{d}W^{(l)} &= \delta_{k,l} \mathrm{d} t
\end{cases} \tag{$\star$}
$$

**乘积法则**
对于下列情形
$$
\begin{align} \mathrm{d} X_{1} &= F_{1} \mathrm{d} t + \sum\limits_{k=1}^{m} G_{1}^{(k)} \mathrm{d} W^{(k)}\\ \mathrm{d} X_{2} &= F_{2} \mathrm{d} t + \sum\limits_{l=1}^{m} G_{2}^{(l)} \mathrm{d} W^{(k)}\\ \end{align}
$$
要根据乘积法则计算 $\mathrm{d} X_{1} \mathrm{d} X_{2}$，同样地，可以先形式上的写成
$$
\mathrm{d}(X_{1}X_{2}) = X_{1}\mathrm{d}X_{2} + X_{2}\mathrm{d}X_{1} + \mathrm{d}X_{1}\mathrm{d}X_{2}
$$
然后按照 $(\star)$ 的规则化简。

**上面的化简规则和助记法**

读者也许心理不太踏实：为什么只要按照上面的助记法来推就可以推出正确的乘积法则和链式法则？为什么 $(\star)$ 中的

