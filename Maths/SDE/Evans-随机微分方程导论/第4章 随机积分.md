# 第四章 随机积分
## 4.1 预备知识

在第一章里面我们看到了随机微分方程的形态
$$
\begin{align}
\mathrm{d}\boldsymbol{X} &= \boldsymbol{b}(\boldsymbol{X}, t)\mathrm{d}t + \boldsymbol{B}(\boldsymbol{X}, t)\mathrm{d}\boldsymbol{W}\\
\boldsymbol{X}(0) &= \boldsymbol{X}_{0}
\end{align}
$$
其中  $\boldsymbol{B}: \mathbb{R}^{n} \rightarrow \mathbb{M}^{n \times m}$。在这章中它将被转化为
$$
\boldsymbol{X}(t) = \boldsymbol{X}_{0} + \int_{0}^{t} \boldsymbol{b}(\boldsymbol{X}, s) \, \mathrm{d}s + \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) \, \mathrm{d}\boldsymbol{W} , \quad t \geqslant 0.
$$
但在此之前，我们首先要弄清楚对于满足 "恰当" 性质的随机过程 $\boldsymbol{G}$， $\displaystyle \int_{0}^{T} \boldsymbol{G} \, \mathrm{d}\boldsymbol{W}$ 到底是什么意思，我们应该怎么定义它。

然而这件事似乎并不显然：Brown 运动的采样路径 $t \mapsto \boldsymbol{W}(t, \omega)$ 对几乎所有 $\omega$ 都有无限变差，这个积分项显然不能按照通常的积分理解。

### 4.1.1 Paley-Wiener-Zygmund 随机积分

当 $m=n=1$ 时，我们首先介绍 Paley，Wiener 和 Zygmund 提出的定义

> **定义 4.1 （Paley-Wiener-Zygmund, 随机积分）**
> 考虑连续可微的函数 $g: [0, T] \rightarrow \mathbb{R}$，有 $g(0) = g(T) = 0$，定义 
> $$\int_{0}^{T} g \, \mathrm{d}W \coloneqq -\int_{0}^{T} g'W \, \mathrm{d}t  $$

注意 $\displaystyle \int_{0}^{T} g \, \mathrm{d}W$ 是随机变量。接下来看一些随机积分的性质

> **引理 4.2**
> 1. $\displaystyle E\left( \int_{0}^{T} g \, \mathrm{d}W \right) = 0$
> 2. $\displaystyle E\left[ \left( \int_{0}^{T} g \, \mathrm{d}W \right)^{2} \right] = \int_{0}^{T} g^{2} \, \mathrm{d}t$

**证明.**
（1）$\displaystyle E\left( \int_{0}^{T} g \, \mathrm{d}W \right) = -E\left( \int_{0}^{T} g'W \, \mathrm{d}t \right) = -\int_{0}^{T} g'E(W) \, \mathrm{d}t = 0$
（2）
$$
\begin{align}
E\left[ \left( \int_{0}^{T} g \, \mathrm{d}W \right)^{2} \right] &= E\left[ \left( \int_{0}^{T} g'W \, \mathrm{d}s \right) \left( \int_{0}^{T} g'W \, \mathrm{d}t \right) \right]\\
&= E\left[ \int_{0}^{T} \int_{0}^{T}  g'(s)g'(t)\underbrace{ W(s)W(t) }_{ s \wedge t } \, \, \mathrm{d}s\mathrm{d}t  \right]\\
&= E\left[ \int_{0}^{T} g'(t)\left( {\color{red}\int_{0}^{t}  sg'(s) \, \, \mathrm{d}s} + {\color{blue} t\int_{t}^{T}  g'(s) \, \, \mathrm{d}s }  \right)\mathrm{d}t  \right]\\
&= E\left[ \int_{0}^{T} g'(t)\left( {\color{red} tg(t)-\int_{0}^{t} g(s) \, \mathrm{d}s }   + {\color{blue} t(\underbrace{ g(T) }_{ 0 } - g(t))  } \right)\mathrm{d}t  \right] & \begin{array}{l}{\color{red} 分部积分} \\
\color{blue}\text{Newton-Leibniz 公式}\end{array}\\
&= -E \left[ \int_{0}^{T} g'(t)U  \left( \int_{0}^{t} g(s) \, \mathrm{d}s  \right)  \, \mathrm{d}t  \right] \\
&= -E\left[ \underbrace{ \left. g(t)\int_{0}^{t} g(s) \, \mathrm{d}s  \right|^{T}_{0} }_{ 0 } - \int_{0}^{T} [g(t)]^{2} \, \mathrm{d}t  \right] = \int_{0}^{T} g^{2} \, \mathrm{d}t. & 分部积分
\end{align}
$$

事实上我们可以对定义 4.1 做推广：考虑 $g \in L^{2}(0, T)$，以及一个函数序列 $\{ g_{n} \}$，其中 $g_{i} \in \mathscr{C}^{1}$，同时满足 $g_{i}(0) = g_{i}(T) = 0$，使得 $\displaystyle \int_{0}^{T} (g_{n}-g)^{2}\, \mathrm{d}t = 0$，根据性质 2 和积分的线性性，有
$$
\begin{align}
E\left[ \left( \int_{0}^{T} g_{m} \, \mathrm{d}W - \int_{0}^{T} g_{n} \, \mathrm{d}W  \right)^{2} \right] &= E\left[ \left( \int_{0}^{T} (g_{m}  -  g_{n}) \, \mathrm{d}W  \right)^{2} \right] = \int_{0}^{T} (g_{m}-g_{n})^{2} \, \mathrm{d}t 
\end{align}
$$
因此 $\displaystyle \left\{  \int_{0}^{T} g_{n} \, \mathrm{d}W  \right\}_{n=1}^{\infty}$ 在 $L^{2}(\Omega)$ 中是一个 Cauchy 列。因此我们可以定义 
$$
\int_{0}^{T} g \, \mathrm{d}W  \coloneqq \lim_{ n \to \infty } \int_{0}^{T} g_{n} \, \mathrm{d}W 
$$
这样对原定义的拓展依然满足引理中的两条性质。

> **注释 4.3**
> 由于在 Paley-Wiener-Zygmund 的定义中要求 $g$ 是一个确定的函数。我们还是没有办法处理 $\displaystyle \int_{0}^{t} \boldsymbol{B}(\boldsymbol{X}, s) \, \mathrm{d}\boldsymbol{W}$ 这样的东西，因此我们必须将其拓展到更大范围的被积对象上，并在确定函数情况下和 Paley-Wiener-Zygmund 的定义保持一致。

### 4.1.2 Riemann 和

在开始进一步讨论之前，我们来看看对于一个一维 Brown 运动 
$$\int_{0}^{T} {W} \, \mathrm d{W}$$
应该如何定义。一个比较自然的方法是用 Riemann 和然后取极限（如果极限存在）。

> **定义 4.4 （划分）**
> 给定区间 $[0, T]$，它的一个划分（partition） $P$ 是该区间中的有限个不同的点构成的集合 $P:=\{ 0 = t_{0} < t_{1} <\cdots < t_{m} = T \}$。该划分的 *网格大小* 定义为 $\displaystyle |P| := \max_{0 \leqslant k \leqslant m-1} |t_{k+1}-t_{k}|$。对于固定的 $0 \leqslant \lambda \leqslant 1$，和 $[0, T]$ 上的给定划分 $P$，定义 $\tau_{k} := (1-\lambda)t_{k} + \lambda t_{k+1}$，它是 $[t_{k}, t_{k+1}]$ 区间上的一点。

> **定义 4.5 （ $\displaystyle \int_{0}^{T} {W} \, \mathrm d{W}$ 的 Riemann 和估计）**
> 对于 $[0, 1]$ 上的给定划分 $P$，记
> $$R = R(P, \lambda) := \sum\limits_{k=0}^{m-1} W(\tau_{k})\big[ W(t_{k+1})-W(t_{k}) \big] $$
> 为随机积分 $\displaystyle \int_{0}^{T} {W} \, \mathrm d{W}$ 的 Riemann 和估计。

我们的核心问题是，固定 $\lambda$ 的值上述估计在 $|P| \rightarrow 0$ 时会发生什么？

> **引理 4.6 （二次变差）**
> 考虑 $[0, \infty)$ 上的一个区间 $[a, b]$，定义该区间上的一个划分序列
> $$P^{(n)} := \{ a = t_{0}^{(n)} < t_{1}^{(n)} < \cdots < t_{m_{n}}^{(n)} = b \}$$
> 它满足当 $n \rightarrow \infty$ 时，$|P^{(n)}| \rightarrow 0$。于是有在 $L^{2}(\Omega)$ 中当 $n \rightarrow \infty$ 时，有
> $$Q_n = \sum\limits_{k=0}^{m_{n}-1} \big[ W(t_{k+1}^{(n)}) - W(t_{k}^{(n)}) \big]^{2} \rightarrow b-a$$

**证明.**
首先注意到
$$
Q_{n} - (b - a) = \sum\limits_{k=0}^{m_{n}-1}  \Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) \Big).
$$
因此
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} \sum\limits_{j=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) \Big)\\&\hspace{7em}\times \Big(\big[ W\big(t_{j+1}^{(n)}\big) - W\big(t_{j}^{(n)}\big) \big]^{2} - \big(t_{j+1}^{(n)} - t_{j}^{(n)}\big) \Big) \Big]  
\end{align}
$$
当两个求和指标 $k$ 和 $j$ 不同时，根据 Brown 运动的增量独立性，有 $W(t_{k+1}^{(n)}) - W(t_{k}^{(n)})) \sim N(0, t_{k+1}^{(n)} - t_{k}^{(n)})$。因此
$$
\begin{align}
&\,E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\Big]\\
=&\, E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2}\Big] - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\\
=&\,\underbrace{ (t_{k+1}^{(n)} - t_{k}^{(n)}) }_{ \sigma^{2}=t_{k+1}^{(n)} - t_{k}^{(n)} } + \underbrace{ 0 }_{ \mu^{2}=0 } - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) = 0.
\end{align}
$$
因此双重求和中的非 “对角” 项都为零，就得到当 $n \rightarrow \infty$ 时，
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)  \Big)^{2}\Big]  \\
&= \sum\limits_{k=0}^{m_{n}-1}  
{\color{red} \underbrace{E\Big[ \big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{4} }_{ 四阶原点矩 = \mu^{4} + 6\mu^{2} \sigma^{2} + 3\sigma^{4}}\Big] }  - 2{\color{blue} \underbrace{E\Big[ \big[W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} \Big]}_{ 二阶原点矩=\mu^{2}+\sigma^{2}=t_{k+1}^{(n)} - t_{k}^{(n)} } } \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)\\&\hspace{5em} + \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}\\
&= \sum\limits_{k=0}^{m_{n}-1}  
{\color{red} 3 \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} }  - {\color{blue} 2 \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} }  + \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}\\
&= 2\sum\limits_{k=0}^{m_{n}-1} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} \leqslant 2|P^{n}|\sum\limits_{k=0}^{m_{n}-1} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big) = 2|P^{n}|(b-a) \rightarrow 0.
\end{align}
$$
除此之外因为我们发现 $W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big)$ 的方差恰好就是 $t_{k+1}^{(n)} - t_{k}^{(n)}$，因此还可以这样做
$$
\begin{align}
E\Big[ (Q_{n} - (b-a))^{2} \Big] &= \sum\limits_{k=0}^{m_{n}-1} E\Big[ 
\Big(\big[ W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big]^{2} - \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)  \Big)^{2}\Big]  \\
 &= \sum\limits_{k=0}^{m_{n}-1} E\left[ 
\left(\left[ \frac{W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big)}{\color{red} \sqrt{ t_{k+1}^{(n)} - t_{k}^{(n)} }}  \right]^{2} - 1 \right)^{2}{\color{red} \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} } \right]  \\
&= \sum\limits_{k=0}^{m_{n}-1} E[\left( Y_{n} - 1 \right)^{2}] \cdot \big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2} \leqslant C\sum\limits_{k=0}^{m_{n}-1}\big(t_{k+1}^{(n)} - t_{k}^{(n)}\big)^{2}. 
\end{align}
$$
> **注释 4.7 （$\mathrm{d}W \approx \mathrm{d}t^{1/2}$）**
> 可以看出，对于微小的时间增量 $\mathrm{d}t$，Brown 运动（轨道）的增量 $\mathrm{d}W$ 服从 Gauss 分布 $N(0, \mathrm{d}t)$，其标准差恰好是 $\mathrm{d}t^{1/2}$，这说明在时间间隔 $\mathrm{d}t$ 内，轨道增量 $\mathrm{d}W$ 的变化水平大致是 $\mathrm{d}t^{1/2}$，这一定程度上解释了第一章中提到的 $\mathrm{d}W \approx \mathrm{d}t^{1/2}$ 这件事情。

> **注释 4.8 （Brown 运动轨道在区间上变差几乎必然无限）**
> 另一方面，因为当 $n \rightarrow \infty$ 时，$Q_{n}$ 在 $L^{2}(\Omega)$ 中有极限 $b-a$。由于 Brown 运动本身对一切 $0 < \gamma < \displaystyle \frac{1}{2}$，我们在样本空间中找一个样本点使得该结论成立，这个样本点对应的 Brown 运动轨道有一致 $\gamma$-Hölder 连续性，因此存在 $K$，使得
> $$\begin{align} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big| &\leqslant K \big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma}\\ \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\ \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \sum\limits_{k=0}^{m_{n}-1}\big|t_{k+1}^{(n)} - t_{k}^{(n)}\big|^{\gamma} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\ &\leqslant K \big|P^{(n)}\big|^{\gamma}\sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|\\b-a=\limsup_{ n \to \infty } \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big|^{2} &\leqslant K \limsup_{ n \to \infty } |P^{(n)}|^{\gamma} \sum\limits_{k=0}^{m_{n}-1} \big| W\big(t_{k+1}^{(n)}\big) - W\big(t_{k}^{(n)}\big) \big| \end{align}$$
> 由于 $|P^{(n)}| \rightarrow 0$，等式右边最后一项必须满足 
> $$\sup_{[b-a]\text{ 的划分 }P} \left\{ \sum\limits_{k=0}^{m_{n}-1} |W(t_{k+1})-W(t_{k})| \right\} = \infty.$$
> 这就证明了 Brown 运动轨道在任意闭区间 $[a, b]$ 上的变差是无穷大。

## 4.2 Itô 积分
### 4.2.1 非预期过程

### 4.2.2 阶梯过程

### 4.2.3 Itô 积分的定义和性质

### 4.2.4 定义的推广

### 4.2.5 不定 Itô 积分

## 4.3 Itô 积分的链式法则和乘积法则
### 4.3.1 链式法则

### 4.3.2 链式法则的应用

### 4.3.3 乘积法则

### 4.3.4 链式法则的证明

### 4.3.5 链式法则的拓展形式



## 4.4 高维空间中的 Itô 积分
### 4.4.1 定义和记号

### 4.4.2 乘积法则和链式法则

### 4.4.3 乘积法则和链式法则的助记法

